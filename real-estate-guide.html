<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Pavlo Rospopa Expert Strategy Engine</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/format.css">
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>

    <style>
        body { -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f7f9; }
        input, textarea { -webkit-user-select: text; -moz-user-select: text; -ms-user-select: text; user-select: text; }

        #real-estate-guide-container {
            margin: 40px auto; padding: 30px; border: 1px solid #e0e0e0; border-radius: 12px;
            background-color: #ffffff; box-shadow: 0 4px 15px rgba(0,0,0,0.05); position: relative; z-index: 101;
            max-width: 950px;
        }
        .tree-option-btn {
            padding: 12px 16px; background-color: #f8f9fa; color: #333; border: 2px solid #eef0f2;
            border-radius: 8px; cursor: pointer; font-size: 0.95rem; text-align: left;
            transition: all 0.2s; font-weight: 500; width: 100%; margin-bottom: 6px; display: block;
        }
        .tree-option-btn:hover { border-color: #4285F4; color: #4285F4; transform: translateX(4px); }
        .result-card { background: #f4f7ff; border-left: 6px solid #4285F4; padding: 25px; border-radius: 8px; color: #334155; line-height: 1.7; margin-bottom: 20px; }

        #contact-form-container { margin: 40px 0; padding: 20px; border: 1px solid #e0e0e0; border-radius: 8px; background-color: #f9f9f9; }
        #contact-form { display: flex; flex-direction: column; gap: 15px; }
        #contact-form input, #contact-form textarea { padding: 12px; border: 1px solid #ccc; border-radius: 4px; width: 100%; box-sizing: border-box; }
        #contact-form button { padding: 12px 24px; background-color: #333; color: white; border: none; border-radius: 4px; cursor: pointer; align-self: flex-start; font-weight: bold; }
        #contact-form button:hover { background-color: #555; }
        
        .progress-container { width: 100%; height: 8px; background: #eee; border-radius: 4px; margin: 15px 0; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #4285F4, #34a853); transition: width 0.3s ease; }
    </style>
</head>
     
<body>

<header class="site-header">
    <div class="wrap" style="text-align: center; padding: 20px 0;">
        <a class="site-title" style="text-decoration: none; font-size: 2rem; color: #333; font-weight: 800;" href="https://rospopa.com">Pavlo Rospopa Strategy Engine</a>
    </div>
</header>

<main>
    <div class="page-content">
        <div class="wrap">
            <div id="real-estate-guide-container">
                
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <button id="back-btn" style="background:none; border:none; color:#4285F4; cursor:pointer; font-weight:bold; display:none;">‚Üê Back</button>
                    <span id="step-counter" style="color:#888; font-size:0.9rem;">Start</span>
                </div>
                
                <div class="progress-container">
                    <div id="progress-bar-fill" class="progress-fill" style="width: 1%;"></div>
                </div>

                <div id="tree-content">
                    <h2 id="question-text" style="margin-bottom: 25px; font-size: 1.4rem; color: #222; font-weight: 700;">Loading Logic...</h2>
                    <div id="options-container"></div>
                </div>

                <div id="contact-form-container" style="display: none;">
                    <h3 style="margin-top:0;">Request This Strategy</h3>
                    <p style="font-size: 0.9rem; color: #666; margin-bottom: 15px;">Based on your answers, this is the most efficient path forward.</p>
                    <form id="contact-form">
                        <input type="text" name="name" placeholder="Your Name" required />
                        <input type="email" name="email" placeholder="Your Email" required />
                        <input type="tel" name="phone" placeholder="Phone Number (Optional)" />
                        <textarea id="message-field" name="message" rows="5" required></textarea>
                        <div class="g-recaptcha" data-sitekey="6Let_E8sAAAAAP948s5QuqjQ-HKYRuoXxLzILZ9p"></div>
                        <button type="submit" id="submit-btn">Send Request</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</main>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const tree = {
        // --- ROOT ---
        start: {
            text: "What is your primary Real Estate Goal?",
            options: [
                { label: "Residential: Buying", next: "buy_node_1" },
                { label: "Residential: Selling", next: "sell_node_1" },
                { label: "Refinancing / Mortgage", next: "refi_node_1" },
                { label: "Wealth: Investing", next: "invest_node_1" },
                { label: "Commercial / Business", next: "comm_node_1" },
                { label: "Land / Development", next: "land_node_1" }
            ]
        },

        // ==========================================
        // BRANCH 1: BUYING (FINANCING DEEP DIVE)
        // ==========================================
        buy_node_1: {
            text: "Are you a US Citizen or Permanent Resident?",
            options: [
                { label: "Yes", next: "buy_loc_status" },
                { label: "No (Visa/Foreign National)", next: "buy_visa_status" }
            ]
        },
        buy_visa_status: { 
            text: "Do you have a valid Work Visa or ITIN?",
            options: [
                { label: "Work Visa (H1B, etc)", next: "buy_loc_status" },
                { label: "ITIN Number only", next: "strat_itin_loan" },
                { label: "Foreign National (No US Credit)", next: "strat_foreign_national" }
            ]
        },
        buy_loc_status: {
            text: "Buying Locally or Relocating?",
            options: [
                { label: "Buying Locally", next: "buy_who_check" },
                { label: "Relocating", next: "buy_relo_check" }
            ]
        },
        buy_relo_check: {
            text: "Are you keeping your current job?",
            options: [
                { label: "Yes, Remote Work", next: "strat_remote_worker_letter" }, // NEW
                { label: "Yes, Transfer", next: "strat_transfer_letter" },
                { label: "No, New Job", next: "buy_job_gap" }
            ]
        },
        buy_job_gap: {
            text: "Is there a gap between jobs?",
            options: [
                { label: "No, start immediately", next: "strat_offer_letter_loan" },
                { label: "Yes, >30 days gap", next: "strat_gap_employment" }
            ]
        },
        buy_who_check: {
            text: "Who is on the loan?",
            options: [
                { label: "Just Me / Spouse", next: "buy_history_check" },
                { label: "Unmarried Partner", next: "strat_co_buy_agreement" },
                { label: "Parent / Co-Signer", next: "strat_cosigner_fha" },
                { label: "Buying from Family", next: "strat_identity_interest" } // NEW
            ]
        },
        buy_history_check: {
            text: "Have you owned a home in the last 3 years?",
            options: [
                { label: "No (First-Time Buyer)", next: "buy_fthb_triage" },
                { label: "Yes (Repeat Buyer)", next: "buy_repeat_triage" }
            ]
        },
        
        // --- FINANCING TRIAGE ---
        buy_fthb_triage: {
            text: "Biggest Hurdle?",
            options: [
                { label: "Down Payment", next: "buy_down_source" },
                { label: "Credit Score", next: "buy_credit_deep" },
                { label: "Income Type", next: "buy_income_check" },
                { label: "Debt Load", next: "buy_debt_check" } // NEW
            ]
        },
        
        // --- INCOME EXPANSION ---
        buy_income_check: {
            text: "Income Source?",
            options: [
                { label: "W-2 Salary", next: "buy_w2_tenure" },
                { label: "Self-Employed", next: "buy_se_type" }, // Deep dive
                { label: "Commission/Bonus", next: "buy_var_income" },
                { label: "Tip Income", next: "buy_tip_income" },
                { label: "Fixed (SS/Pension)", next: "strat_fixed_income_gross_up" } // NEW
            ]
        },
        buy_se_type: { // NEW
            text: "How do you file taxes?",
            options: [
                { label: "Sole Proprietor (Sched C)", next: "buy_se_writeoffs" },
                { label: "S-Corp / K-1", next: "buy_scorp_income" }
            ]
        },
        buy_se_writeoffs: {
            text: "Do you write off most expenses?",
            options: [
                { label: "Yes, low net income", next: "buy_bank_statement_check" },
                { label: "No, high net income", next: "res_conventional_check" }
            ]
        },
        buy_bank_statement_check: { // NEW
            text: "Do you have 12 months of business bank statements?",
            options: [
                { label: "Yes, consistent deposits", next: "strat_bank_statement" },
                { label: "No, mostly cash", next: "strat_1099_only_loan" }
            ]
        },
        buy_scorp_income: { // NEW
            text: "How many years in business?",
            options: [
                { label: "5+ Years", next: "strat_1yr_tax_return" },
                { label: "2-4 Years", next: "res_conventional_check" },
                { label: "<2 Years", next: "strat_manual_underwriting" }
            ]
        },
        
        // --- CREDIT EXPANSION ---
        buy_credit_deep: {
            text: "Score Range?",
            options: [
                { label: "720+", next: "res_conventional_check" },
                { label: "620-719", next: "res_fha_standard" },
                { label: "580-619", next: "buy_credit_issues" },
                { label: "<580", next: "res_credit_repair" }
            ]
        },
        buy_credit_issues: {
            text: "Specific Issue?",
            options: [
                { label: "Bankruptcy", next: "buy_bk_type" }, // NEW
                { label: "Foreclosure", next: "buy_foreclosure_date" }, // NEW
                { label: "Collections/Charge-offs", next: "strat_medical_collections" }
            ]
        },
        buy_bk_type: { // NEW
            text: "Chapter 7 or 13?",
            options: [
                { label: "Chapter 7", next: "buy_bk7_date" },
                { label: "Chapter 13", next: "strat_bk13_manual" }
            ]
        },
        buy_bk7_date: { // NEW
            text: "Discharge Date?",
            options: [
                { label: "<2 Years ago", next: "strat_hard_money_buy" },
                { label: "2-4 Years ago", next: "res_fha_standard" },
                { label: "4+ Years ago", next: "res_conventional_check" }
            ]
        },

        // --- PROPERTY TYPE EXPANSION ---
        buy_inventory_triage: {
            text: "Property Type?",
            options: [
                { label: "Standard SFH", next: "buy_sfh_features" },
                { label: "Condo/Co-Op", next: "buy_condo_type" }, // Updated
                { label: "Niche/Unique", next: "buy_niche_prop" }, // NEW
                { label: "Manufactured", next: "buy_manu_type" } // NEW
            ]
        },
        buy_condo_type: { // NEW
            text: "Condo or Co-Op?",
            options: [
                { label: "Condo", next: "buy_condo_check" },
                { label: "Co-Op", next: "strat_coop_board" }
            ]
        },
        buy_manu_type: { // NEW
            text: "Do you own the land?",
            options: [
                { label: "Yes (Real Property)", next: "buy_manu_foundation" },
                { label: "No (Leased Land)", next: "strat_chattel_loan" }
            ]
        },
        buy_manu_foundation: { // NEW
            text: "Is it on a permanent foundation?",
            options: [
                { label: "Yes, HUD Tags present", next: "strat_fha_manufactured" },
                { label: "No / Pre-1976", next: "strat_cash_only_manu" }
            ]
        },
        buy_niche_prop: { // NEW
            text: "Specific Style?",
            options: [
                { label: "Barndominium", next: "strat_barndominium" },
                { label: "Log Cabin", next: "strat_log_cabin" },
                { label: "Geodesic Dome / Earth", next: "strat_unique_appraisal" }
            ]
        },
        
        // --- SELLING BRANCH (Expanded) ---
        sell_node_1: {
            text: "Property Status?",
            options: [
                { label: "Occupied", next: "sell_reason_check" },
                { label: "Vacant", next: "sell_vacant_issues" },
                { label: "Tenanted", next: "sell_tenant_lease" }
            ]
        },
        sell_reason_check: {
            text: "Selling Motivation?",
            options: [
                { label: "Move Up/Down", next: "sell_taxes_check" },
                { label: "Divorce", next: "sell_divorce_status" },
                { label: "Estate/Probate", next: "sell_probate" },
                { label: "Financial Distress", next: "sell_distress" }
            ]
        },
        sell_taxes_check: {
            text: "Lived in 2 of last 5 years?",
            options: [ { label: "Yes", next: "sell_solar_check" }, { label: "No", next: "strat_cap_gains_calc" } ]
        },
        sell_solar_check: {
            text: "Solar Panels?",
            options: [
                { label: "Owned", next: "strat_green_marketing" },
                { label: "Leased", next: "strat_solar_lease_transfer" }, // Critical path
                { label: "None", next: "sell_pool_check" }
            ]
        },
        sell_pool_check: { // NEW
            text: "Do you have a pool?",
            options: [
                { label: "Yes, In-Ground", next: "strat_pool_marketing" },
                { label: "No", next: "sell_luxury_check" }
            ]
        },

        // --- INVESTING (Expanded) ---
        invest_node_1: {
            text: "Strategy?",
            options: [
                { label: "Long Term Rental", next: "inv_unit_count" },
                { label: "Short Term (STR)", next: "inv_str_type" }, // Expanded
                { label: "Commercial", next: "comm_node_1" },
                { label: "Land", next: "land_node_1" }
            ]
        },
        inv_str_type: { // NEW
            text: "STR Location Type?",
            options: [
                { label: "Urban / Condo", next: "strat_str_urban_reg" },
                { label: "Vacation / Cabin", next: "strat_str_vacation" },
                { label: "Glamping / Unique", next: "strat_str_glamping" }
            ]
        },

        // --- COMMERCIAL (Expanded) ---
        comm_node_1: {
            text: "Asset Class?",
            options: [
                { label: "Retail", next: "comm_retail_node" },
                { label: "Office", next: "comm_office_node" },
                { label: "Industrial", next: "comm_industrial_node" },
                { label: "Special Purpose", next: "comm_special_purpose" } // NEW
            ]
        },
        comm_special_purpose: { // NEW
            text: "Specific Use?",
            options: [
                { label: "Gas Station", next: "comm_env_check" },
                { label: "Car Wash", next: "strat_operational_asset" },
                { label: "Church / Religious", next: "strat_religious_zoning" },
                { label: "Data Center", next: "strat_data_center" }
            ]
        },
        comm_industrial_node: {
            text: "Feature Requirement?",
            options: [
                { label: "Cold Storage", next: "strat_cold_storage" },
                { label: "Heavy Power", next: "strat_heavy_industrial" },
                { label: "Loading Docks", next: "strat_industrial_logistics" }
            ]
        },
        comm_retail_node: {
            text: "Requirement?",
            options: [
                { label: "Drive-Thru", next: "strat_drive_thru" },
                { label: "End Cap", next: "comm_lease_own" }
            ]
        },
        comm_office_node: {
            text: "Class?",
            options: [
                { label: "Class A (Turnkey)", next: "comm_lease_own" },
                { label: "Class C (Value Add)", next: "strat_office_conversion" } // NEW
            ]
        },

        // ==========================================
        // OUTCOMES
        // ==========================================
        
        // --- NEW OUTCOMES (Total >190) ---
        strat_1yr_tax_return: { text: "Strategy: Freddie Mac 1-Year Program. Since your business is established (5+ years), we can qualify you using only your most recent tax return if it's stronger than the previous year.", options: [] },
        strat_1099_only_loan: { text: "Strategy: 1099-Only Loan. No tax returns, no bank statements. We qualify you based strictly on your 1099 forms from the last 1-2 years. Requires higher credit and down payment.", options: [] },
        strat_identity_interest: { text: "Strategy: Family Gift of Equity. Buying from family allows them to 'gift' you the equity as your down payment. You can buy with $0 out of pocket. We must watch out for the 85% LTV limit on FHA family deals.", options: [] },
        strat_bk13_manual: { text: "Strategy: Chapter 13 Buy-Out. If you have made 12 on-time payments to the trustee and get court permission, you can buy a home via FHA manual underwriting *before* discharge.", options: [] },
        strat_chattel_loan: { text: "Strategy: Chattel Financing. Since you don't own the land (Park Model), this is personal property, not real estate. Rates are higher, terms shorter (15-20 years).", options: [] },
        strat_fha_manufactured: { text: "Strategy: FHA Title II. If the home has HUD tags and is on a permanent foundation, it qualifies for FHA 3.5% down financing just like a stick-built home.", options: [] },
        strat_barndominium: { text: "Strategy: Barndo Appraisal Gap. Lenders struggle to find comps for Barndominiums. We need a local lender who keeps loans in-house (Portfolio) rather than selling to Fannie/Freddie.", options: [] },
        strat_coop_board: { text: "Strategy: Co-Op Board Package. You are buying shares in a corporation, not real estate. The Board Interview is critical. We must prepare a financial package showing high post-closing liquidity.", options: [] },
        strat_office_conversion: { text: "Strategy: Adaptive Reuse. Converting Class C office to Residential. We need to check floor plates for plumbing access and verify zoning allows multi-family density.", options: [] },
        strat_drive_thru: { text: "Strategy: Special Use Permit (SUP). Drive-thrus are heavily regulated. We need to buy contingent on acquiring the SUP from the village, focusing on traffic stacking lanes.", options: [] },
        strat_cold_storage: { text: "Strategy: Cold Storage Premium. Refrigerated warehouses trade at a lower Cap Rate (higher value). We need to inspect the insulation integrity and compressor age.", options: [] },
        strat_data_center: { text: "Strategy: Power & Fiber. The value is in the grid connection (MW capacity) and fiber redundancy, not the building. We need a specialized inspection of the cooling systems.", options: [] },
        strat_str_glamping: { text: "Strategy: Land Use Permit. Glamping is zoning-intensive. We must ensure the county allows temporary structures (Yurts/Domes) and address sewage (Septic vs Composting Toilets).", options: [] },
        strat_religious_zoning: { text: "Strategy: Religious Use Exemption. Churches often don't pay property taxes. Converting a church to residential or commercial triggers a massive tax reassessment. We must underwrite the new tax bill.", options: [] },
        strat_remote_worker_letter: { text: "Strategy: Remote Work Verification. We need a letter from HR stating you can work from *anywhere*. If the letter says 'remote from [Current City]', lenders won't accept it for a move.", options: [] },
        strat_transfer_letter: { text: "Strategy: Transfer Date Alignment. We can close on the new home based on your transfer letter's future start date, as long as it is within 60 days of closing.", options: [] },
        strat_fixed_income_gross_up: { text: "Strategy: Non-Taxable Income Gross Up. If you receive Social Security or Disability, lenders can 'gross up' this income by 125% because it is tax-free, helping your DTI.", options: [] },
        strat_offer_letter_loan: { text: "Strategy: Future Income Loan. We can use your Offer Letter for a new job to qualify you before you receive your first paystub, provided you start within 60-90 days.", options: [] },
        strat_pool_marketing: { text: "Strategy: Seasonal Marketing. Pools add value in May-July but are a liability in winter. We must highlight the 'Lifestyle' aspect with summer photos if listing in off-season.", options: [] },
        strat_unique_appraisal: { text: "Strategy: Complex Property Appraiser. Domes and Earth homes fail standard appraisal logic. We must request a specific appraiser with experience in unique properties to avoid a low value.", options: [] },

        // --- RETAINED OUTCOMES ---
        strat_itin_loan: { text: "Strategy: ITIN Financing. 15-20% down using ITIN tax returns.", options: [] },
        strat_foreign_national: { text: "Strategy: Foreign National Loan. DSCR loan for non-residents.", options: [] },
        strat_co_buy_agreement: { text: "Strategy: Co-Buying Agreement. Title as 'Tenants in Common'.", options: [] },
        strat_corp_relo: { text: "Strategy: Corporate Relocation Rider. Protect benefits.", options: [] },
        strat_tiny_home: { text: "Strategy: Tiny Home Zoning. Check for ADU compliance.", options: [] },
        strat_hoarder_cleanout: { text: "Strategy: Discrete Cleanout. Compassionate crew first.", options: [] },
        strat_vacant_staging: { text: "Strategy: Virtual Staging. Digital furniture for empty rooms.", options: [] },
        strat_utility_activation: { text: "Strategy: Utility De-Winterization. Activate for inspection.", options: [] },
        strat_structural_eng: { text: "Strategy: Structural Engineer Report. Pre-inspect foundation.", options: [] },
        strat_home_warranty: { text: "Strategy: Seller Coverage Warranty. Covers systems during listing.", options: [] },
        strat_solar_lease_transfer: { text: "Strategy: Solar Lease Transfer. Critical path for closing.", options: [] },
        strat_historic_sale: { text: "Strategy: Historic Tax Freeze. Market tax incentives.", options: [] },
        strat_divorce_refi: { text: "Strategy: Owelty Lien. Buyout spouse equity.", options: [] },
        strat_reverse_purchase: { text: "Strategy: HECM for Purchase. 50% down, no payments.", options: [] },
        strat_sdir_custodian: { text: "Strategy: Self-Directed IRA. Custodian required.", options: [] },
        strat_wholesaling: { text: "Strategy: Wholesaling. Assign contract for fee.", options: [] },
        strat_mhp_invest: { text: "Strategy: Mobile Home Park. Own dirt, rent pads.", options: [] },
        strat_student_housing: { text: "Strategy: Student Housing. Rent by bedroom.", options: [] },
        strat_storage_invest: { text: "Strategy: Self-Storage. Climate controlled focus.", options: [] },
        strat_phase_2_env: { text: "Strategy: Phase 2 Environmental. Soil testing required.", options: [] },
        strat_liquor_license: { text: "Strategy: Liquor License. Verify transferability.", options: [] },
        strat_parking_variance: { text: "Strategy: Parking Variance. Zoning petition.", options: [] },
        strat_heavy_manufacturing: { text: "Strategy: Heavy Manufacturing. Floor load capacity.", options: [] },
        strat_ot_avg: { text: "Strategy: Overtime Averaging. 2-year history needed.", options: [] },
        strat_medical_collections: { text: "Strategy: Medical Debt Exclusion. Ignored by many lenders.", options: [] },
        strat_green_marketing: { text: "Strategy: Green Premium. Appraisal addendum for solar.", options: [] },
        strat_virtual_tour: { text: "Strategy: Virtual Relocation. Video tours + rescission period.", options: [] },
        strat_jumbo_loan: { text: "Strategy: Jumbo Financing. Portfolio lenders.", options: [] },
        strat_usda_loan: { text: "Strategy: USDA Rural. 0% down in eligible zones.", options: [] },
        strat_fsbo_conversion: { text: "Strategy: MLS Exposure. Unlock 97% of buyers.", options: [] },
        strat_expired_relist: { text: "Strategy: Market Refresh. New photos and price.", options: [] },
        strat_cap_gains_calc: { text: "Strategy: Tax Analysis. 1031 vs Capital Gains.", options: [] },
        strat_private_showings: { text: "Strategy: Appointment Only. No open houses.", options: [] },
        strat_str_self: { text: "Strategy: Self-Managed Airbnb. High revenue, high effort.", options: [] },
        strat_str_managed: { text: "Strategy: Managed STR. Passive income, lower net.", options: [] },
        strat_land_build: { text: "Strategy: Construction-to-Perm. One close.", options: [] },
        strat_zoning_attorney: { text: "Strategy: Zoning Contingency. Special Use Permit.", options: [] },
        strat_biz_opp: { text: "Strategy: Business Asset Sale. Buy cash flow.", options: [] },
        strat_bank_statement: { text: "Strategy: Bank Statement Loan. 12mo deposits.", options: [] },
        strat_physician_loan: { text: "Strategy: Physician Loan. Exclude student loans.", options: [] },
        strat_manual_underwriting: { text: "Strategy: Manual Underwrite. Non-traditional credit.", options: [] },
        strat_hard_money_buy: { text: "Strategy: Hard Money. Bridge loan for distress.", options: [] },
        strat_new_construction: { text: "Strategy: Builder Rep. Negotiate upgrades.", options: [] },
        strat_builder_reg: { text: "Strategy: Builder Intervention. Contract review.", options: [] },
        strat_divorce_neutral: { text: "Strategy: Neutral Sale. Unbiased representation.", options: [] },
        strat_senior_transition: { text: "Strategy: Rightsizing. Estate sale coordination.", options: [] },
        strat_luxury_private: { text: "Strategy: Private Placement. Off-market.", options: [] },
        strat_eviction_sale: { text: "Strategy: Cash-for-Keys. Vacate before closing.", options: [] },
        strat_probate_conflict: { text: "Strategy: Mediator Sale. Transparent process.", options: [] },
        strat_house_hack_invest: { text: "Strategy: House Hack. FHA 3.5% multifamily.", options: [] },
        strat_multifamily_commercial: { text: "Strategy: DSCR Loan. Income based.", options: [] },
        strat_restaurant_buy: { text: "Strategy: 2nd Gen Restaurant. Save CAPEX.", options: [] },
        strat_medical_office: { text: "Strategy: TI Allowance. Landlord pays buildout.", options: [] },
        strat_flex_space: { text: "Strategy: Flex Space. Industrial/Office mix.", options: [] },
        strat_commuter_hub: { text: "Strategy: Transit Oriented. Train proximity.", options: [] },
        strat_school_zone: { text: "Strategy: District Search. Boundary focus.", options: [] },
        strat_va_loan: { text: "Strategy: VA Loan. 0% down for Vets.", options: [] },
        strat_203k_rehab: { text: "Strategy: FHA 203k. Reno loan.", options: [] },
        res_grant: { text: "Strategy: DPA Grant. Assistance available.", options: [] },
        res_fha_standard: { text: "Strategy: FHA 3.5%. Low down payment.", options: [] },
        res_credit_repair: { text: "Strategy: Credit Roadmap. Fix score first.", options: [] },
        strat_concurrent: { text: "Strategy: Concurrent Closing. Same day.", options: [] },
        strat_bridge: { text: "Strategy: Bridge Loan. Buy then sell.", options: [] },
        strat_sell_first: { text: "Strategy: Contingency. Protected sale.", options: [] },
        strat_vacation: { text: "Strategy: Vacation Analysis. ROI check.", options: [] },
        strat_leaseback: { text: "Strategy: Rent-Back. Post-close possession.", options: [] },
        strat_luxury_listing: { text: "Strategy: Luxury Marketing. Global reach.", options: [] },
        strat_tenant_sale: { text: "Strategy: Investor Sale. Sell with tenant.", options: [] },
        strat_concierge: { text: "Strategy: Concierge. Max prep/price.", options: [] },
        strat_instant: { text: "Strategy: Instant Offer. Speed focus.", options: [] },
        strat_hold_rent: { text: "Strategy: Rent & Hold. Wait for equity.", options: [] },
        strat_short_sale: { text: "Strategy: Short Sale. Bank negotiation.", options: [] },
        strat_deed_lieu: { text: "Strategy: Deed in Lieu. Voluntray surrender.", options: [] },
        strat_probate_easy: { text: "Strategy: Independent Admin. Fast probate.", options: [] },
        strat_probate_court: { text: "Strategy: Court Approval. Slow probate.", options: [] },
        strat_probate_bond: { text: "Strategy: Bond in Lieu. Sell early.", options: [] },
        strat_turnkey: { text: "Strategy: Turnkey. Done-for-you.", options: [] },
        strat_dst: { text: "Strategy: DST 1031. Passive exchange.", options: [] },
        strat_fix_flip: { text: "Strategy: Fix & Flip. 70% rule.", options: [] },
        strat_brrrr: { text: "Strategy: BRRRR. Recycle capital.", options: [] },
        strat_buy_hold: { text: "Strategy: Buy & Hold. Long term.", options: [] },
        strat_syndication: { text: "Strategy: Syndication. Group invest.", options: [] },
        strat_reit: { text: "Strategy: REIT. Stock invest.", options: [] },
        strat_hold_refi: { text: "Strategy: Cash Out Refi. Access equity.", options: [] },
        strat_1031: { text: "Strategy: 1031 Exchange. Defer tax.", options: [] },
        strat_sba_504: { text: "Strategy: SBA 504. Owner user.", options: [] },
        strat_lease_audit: { text: "Strategy: NNN Audit. Check expenses.", options: [] },
        strat_lease_base_year: { text: "Strategy: Base Year. Cap expenses.", options: [] },
        strat_industrial_logistics: { text: "Strategy: Logistics. High ceilings.", options: [] },
        res_conventional_check: { text: "Strategy: Conventional. Standard loan.", options: [] },
        strat_streamline_refi: { text: "Strategy: Streamline Refi. No appraisal.", options: [] },
        strat_rate_term_refi: { text: "Strategy: Rate/Term Refi. Lower rate.", options: [] },
        strat_debt_consolidation: { text: "Strategy: Debt Consolidation. Pay cards.", options: [] },
        strat_renovation_heloc: { text: "Strategy: HELOC. Reno funds.", options: [] },
        strat_cash_out_invest: { text: "Strategy: Invest Cash Out. Buy rental.", options: [] },
        strat_pmi_removal: { text: "Strategy: PMI Removal. Appraise out.", options: [] },
        strat_appraisal_gap: { text: "Strategy: Appraisal Gap. Check value.", options: [] },
        strat_fha_ibr: { text: "Strategy: FHA IBR. Student loans.", options: [] },
        strat_conventional_1percent: { text: "Strategy: Conventional Student. 1% calc.", options: [] },
        strat_cosigner_fha: { text: "Strategy: Co-Signer. Blend income.", options: [] },
        strat_condo_warrantable: { text: "Strategy: Warrantable. Healthy HOA.", options: [] },
        strat_non_warrantable: { text: "Strategy: Non-Warrantable. Portfolio loan.", options: [] },
        strat_multigen_search: { text: "Strategy: Multi-Gen. In-law suite.", options: [] },
        strat_remove_disputes: { text: "Strategy: Remove Disputes. Clear credit.", options: [] },
        strat_gift_letter: { text: "Strategy: Gift Letter. Doc funds.", options: [] },
        strat_trust_sale: { text: "Strategy: Trust Sale. Trustee signs.", options: [] },
        strat_retro_permit: { text: "Strategy: Retroactive Permit. Legalize.", options: [] },
        strat_title_clearance: { text: "Strategy: Title Clear. Remove liens.", options: [] },
        strat_reverse_mortgage_sale: { text: "Strategy: HECM Payoff. Sell fast.", options: [] },
        strat_land_feasibility: { text: "Strategy: Feasibility. Soil test.", options: [] },
        strat_cash_out_refi: { text: "Strategy: Cash Out Refi. Full replacement.", options: [] },
        strat_land_hold: { text: "Strategy: Land Banking. Hold.", options: [] },
        strat_gap_employment: { text: "Strategy: Gap Explanation. Explain gap.", options: [] },
        strat_cash_only_manu: { text: "Strategy: Cash Sale. No financing available.", options: [] },
        strat_log_cabin: { text: "Strategy: Log Home Finance. Unique comp requirements.", options: [] },
        strat_str_urban_reg: { text: "Strategy: Urban STR. Check city ban list.", options: [] },
        strat_str_vacation: { text: "Strategy: Vacation Rental. High season revenue.", options: [] },
        strat_str_glamping: { text: "Strategy: Glamping Permit. Zoning check.", options: [] }
    };

    let currentNode = 'start';
    let history = []; 
    let pathLabels = []; 

    const elements = {
        question: document.getElementById('question-text'),
        options: document.getElementById('options-container'),
        backBtn: document.getElementById('back-btn'),
        progress: document.getElementById('progress-bar-fill'),
        step: document.getElementById('step-counter'),
        formContainer: document.getElementById('contact-form-container'),
        message: document.getElementById('message-field')
    };

    function renderNode() {
        const node = tree[currentNode];
        if(!node) {
            console.error("Node not found:", currentNode);
            return;
        }

        elements.question.innerText = node.text;
        elements.options.innerHTML = '';
        
        const isResult = node.options.length === 0;
        const stepCount = history.length + 1;
        
        elements.step.innerText = isResult ? 'Strategy Found' : `Step ${stepCount}`;
        elements.progress.style.width = isResult ? '100%' : Math.min(stepCount * 4, 95) + '%';
        elements.backBtn.style.display = (history.length > 0) ? 'block' : 'none';

        if (isResult) {
            elements.question.classList.add('result-card');
            elements.formContainer.style.display = 'block';
            
            let complianceNote = "\n\n*Local Compliance Note (Villa Park/IL):* \n- Transfer Stamps: $0 (Villa Park), but Inspection Required ($50).\n- Mandatory Disclosures: IL Radon, Lead-Based Paint (Pre-1978).";
            elements.message.value = "Client Path: " + pathLabels.join(" > ") + "\n\nGenerated Strategy: " + node.text + complianceNote;
            
            const restartBtn = document.createElement('button');
            restartBtn.innerText = "Start Over / Try Another Scenario";
            restartBtn.className = "tree-option-btn";
            restartBtn.style.textAlign = "center";
            restartBtn.style.marginTop = "20px";
            restartBtn.style.background = "#fff";
            restartBtn.onclick = () => { 
                history = []; 
                pathLabels = []; 
                currentNode = 'start'; 
                renderNode(); 
            };
            elements.options.appendChild(restartBtn);
        } else {
            elements.question.classList.remove('result-card');
            elements.formContainer.style.display = 'none';
            node.options.forEach(opt => {
                const btn = document.createElement('button');
                btn.innerText = opt.label;
                btn.className = "tree-option-btn";
                btn.onclick = () => {
                    history.push(currentNode);
                    pathLabels.push(opt.label);
                    currentNode = opt.next;
                    renderNode();
                };
                elements.options.appendChild(btn);
            });
        }
    }

    elements.backBtn.onclick = () => {
        if (history.length > 0) {
            currentNode = history.pop();
            pathLabels.pop();
            renderNode();
        }
    };

    renderNode();
});
</script>
</body>
</html>
