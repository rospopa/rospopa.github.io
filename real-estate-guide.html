<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Pavlo Rospopa Expert Strategy Engine</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/format.css">
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>

    <style>
        body { -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f7f9; }
        input, textarea { -webkit-user-select: text; -moz-user-select: text; -ms-user-select: text; user-select: text; }

        #real-estate-guide-container {
            margin: 40px auto; padding: 30px; border: 1px solid #e0e0e0; border-radius: 12px;
            background-color: #ffffff; box-shadow: 0 4px 15px rgba(0,0,0,0.05); position: relative; z-index: 101;
            max-width: 900px;
        }
        .tree-option-btn {
            padding: 14px 18px; background-color: #f8f9fa; color: #333; border: 2px solid #eef0f2;
            border-radius: 8px; cursor: pointer; font-size: 1rem; text-align: left;
            transition: all 0.2s; font-weight: 500; width: 100%; margin-bottom: 8px; display: block;
        }
        .tree-option-btn:hover { border-color: #4285F4; color: #4285F4; transform: translateX(4px); }
        .result-card { background: #f4f7ff; border-left: 6px solid #4285F4; padding: 25px; border-radius: 8px; color: #334155; line-height: 1.7; margin-bottom: 20px; }

        #contact-form-container { margin: 40px 0; padding: 20px; border: 1px solid #e0e0e0; border-radius: 8px; background-color: #f9f9f9; }
        #contact-form { display: flex; flex-direction: column; gap: 15px; }
        #contact-form input, #contact-form textarea { padding: 12px; border: 1px solid #ccc; border-radius: 4px; width: 100%; box-sizing: border-box; }
        #contact-form button { padding: 12px 24px; background-color: #333; color: white; border: none; border-radius: 4px; cursor: pointer; align-self: flex-start; font-weight: bold; }
        #contact-form button:hover { background-color: #555; }
        
        .progress-container { width: 100%; height: 8px; background: #eee; border-radius: 4px; margin: 15px 0; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #4285F4, #34a853); transition: width 0.3s ease; }
    </style>
</head>
     
<body>

<header class="site-header">
    <div class="wrap" style="text-align: center; padding: 20px 0;">
        <a class="site-title" style="text-decoration: none; font-size: 2rem; color: #333; font-weight: 800;" href="https://rospopa.com">Pavlo Rospopa Strategy Engine</a>
    </div>
</header>

<main>
    <div class="page-content">
        <div class="wrap">
            <div id="real-estate-guide-container">
                
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <button id="back-btn" style="background:none; border:none; color:#4285F4; cursor:pointer; font-weight:bold; display:none;">‚Üê Back</button>
                    <span id="step-counter" style="color:#888; font-size:0.9rem;">Start</span>
                </div>
                
                <div class="progress-container">
                    <div id="progress-bar-fill" class="progress-fill" style="width: 2%;"></div>
                </div>

                <div id="tree-content">
                    <h2 id="question-text" style="margin-bottom: 25px; font-size: 1.4rem; color: #222; font-weight: 700;">Loading Logic...</h2>
                    <div id="options-container"></div>
                </div>

                <div id="contact-form-container" style="display: none;">
                    <h3 style="margin-top:0;">Request This Strategy</h3>
                    <p style="font-size: 0.9rem; color: #666; margin-bottom: 15px;">Based on your answers, this is the most efficient path forward.</p>
                    <form id="contact-form">
                        <input type="text" name="name" placeholder="Your Name" required />
                        <input type="email" name="email" placeholder="Your Email" required />
                        <input type="tel" name="phone" placeholder="Phone Number (Optional)" />
                        <textarea id="message-field" name="message" rows="5" required></textarea>
                        <div class="g-recaptcha" data-sitekey="6Let_E8sAAAAAP948s5QuqjQ-HKYRuoXxLzILZ9p"></div>
                        <button type="submit" id="submit-btn">Send Request</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</main>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const tree = {
        // --- ROOT ---
        start: {
            text: "What is your primary Real Estate Goal?",
            options: [
                { label: "Residential: Buying", next: "buy_node_1" },
                { label: "Residential: Selling", next: "sell_node_1" },
                { label: "Refinancing / Mortgage", next: "refi_node_1" },
                { label: "Wealth: Investing", next: "invest_node_1" },
                { label: "Commercial / Business", next: "comm_node_1" }
            ]
        },

        // ==========================================
        // BRANCH 1: BUYING
        // ==========================================
        buy_node_1: {
            text: "Are you a US Citizen or Permanent Resident?",
            options: [
                { label: "Yes", next: "buy_loc_status" },
                { label: "No (Visa/Foreign National)", next: "buy_visa_status" } // NEW
            ]
        },
        buy_visa_status: { // NEW
            text: "Do you have a valid Work Visa or ITIN?",
            options: [
                { label: "Work Visa (H1B, etc)", next: "buy_loc_status" },
                { label: "ITIN Number only", next: "strat_itin_loan" },
                { label: "Foreign National (No US Credit)", next: "strat_foreign_national" }
            ]
        },
        buy_loc_status: {
            text: "Are you buying locally or relocating?",
            options: [
                { label: "Buying Locally", next: "buy_co_buy_check" },
                { label: "Relocating", next: "buy_relo_timeline" }
            ]
        },
        buy_co_buy_check: { // NEW
            text: "Who are you buying with?",
            options: [
                { label: "Just me / Spouse", next: "buy_history_check" },
                { label: "Unmarried Partner / Friend", next: "strat_co_buy_agreement" },
                { label: "Parent / Co-Signer", next: "strat_cosigner_fha" }
            ]
        },
        buy_relo_timeline: {
            text: "Is this a Corporate Move or Self-Move?",
            options: [
                { label: "Corporate Package", next: "strat_corp_relo" }, // NEW
                { label: "Self-Move / Job Change", next: "buy_history_check" }
            ]
        },
        buy_history_check: {
            text: "Have you owned a home in the last 3 years?",
            options: [
                { label: "No (First-Time Buyer)", next: "buy_fthb_triage" },
                { label: "Yes (Repeat Buyer)", next: "buy_repeat_triage" }
            ]
        },
        
        // --- FTHB PATH ---
        buy_fthb_triage: {
            text: "What is your biggest hurdle right now?",
            options: [
                { label: "Down Payment", next: "buy_down_source" },
                { label: "Credit Score", next: "buy_credit_deep" },
                { label: "Income / Debt", next: "buy_income_check" },
                { label: "Inventory / Condition", next: "buy_inventory_triage" }
            ]
        },
        // --- INCOME & DEBT ---
        buy_income_check: {
            text: "Do you have significant Student Loan debt?",
            options: [
                { label: "Yes, Student Loans", next: "buy_student_loan_calc" },
                { label: "No, other debt/income issues", next: "buy_income_type" }
            ]
        },
        buy_student_loan_calc: {
            text: "Are you on an Income-Based Repayment (IBR) plan?",
            options: [
                { label: "Yes, IBR Plan", next: "strat_fha_ibr" },
                { label: "No, Standard Plan", next: "strat_conventional_1percent" }
            ]
        },
        buy_income_type: {
            text: "How is your income derived?",
            options: [
                { label: "W-2 Salary", next: "buy_overtime_check" },
                { label: "Self-Employed", next: "buy_self_emp_years" },
                { label: "Commission/Bonus", next: "buy_variable_income" },
                { label: "Tip Income (Service)", next: "buy_tip_income" } // NEW
            ]
        },
        buy_tip_income: { // NEW
            text: "Do you report all your tips to the IRS?",
            options: [
                { label: "Yes, fully reported", next: "res_fha_standard" },
                { label: "No, mostly cash", next: "strat_bank_statement" }
            ]
        },
        buy_overtime_check: { // NEW
            text: "Do you rely on Overtime pay to qualify?",
            options: [
                { label: "Yes, need OT income", next: "strat_ot_avg" },
                { label: "No, Base Salary is enough", next: "res_fha_standard" }
            ]
        },
        buy_variable_income: {
            text: "Do you have a 2-year history of this variable income?",
            options: [
                { label: "Yes, consistent", next: "res_conventional_check" },
                { label: "No, it varies", next: "strat_base_income_only" }
            ]
        },
        buy_self_emp_years: {
            text: "Do your tax returns show strong net income?",
            options: [
                { label: "Yes, I show profit", next: "res_conventional_check" },
                { label: "No, high write-offs", next: "strat_bank_statement" }
            ]
        },
        // --- CREDIT ---
        buy_credit_deep: {
            text: "Approximate Credit Score?",
            options: [
                { label: "Excellent (720+)", next: "res_conventional_check" },
                { label: "Good (620-719)", next: "res_fha_standard" },
                { label: "Fair (580-619)", next: "buy_credit_issues" },
                { label: "Poor (<580)", next: "res_credit_repair" }
            ]
        },
        buy_credit_issues: {
            text: "Any open disputes or collections?",
            options: [
                { label: "Yes, Disputes", next: "strat_remove_disputes" },
                { label: "Bankruptcy <2 years", next: "strat_hard_money_buy" },
                { label: "Medical Collections", next: "strat_medical_collections" } // NEW
            ]
        },
        // --- DOWN PAYMENT ---
        buy_down_source: {
            text: "Are you a Veteran?",
            options: [ { label: "Yes", next: "strat_va_loan" }, { label: "No", next: "buy_rural_check" } ]
        },
        buy_rural_check: {
            text: "Willing to buy Rural?",
            options: [ { label: "Yes", next: "strat_usda_loan" }, { label: "No", next: "buy_gift_check" } ]
        },
        buy_gift_check: {
            text: "Do you have gift funds?",
            options: [ { label: "Yes", next: "buy_gift_seasoning" }, { label: "No", next: "res_grant" } ]
        },
        buy_gift_seasoning: {
            text: "Are the funds currently in your bank account?",
            options: [ { label: "Yes, >60 days", next: "res_conventional_check" }, { label: "No, wiring later", next: "strat_gift_letter" } ]
        },
        // --- INVENTORY ---
        buy_inventory_triage: {
            text: "Property Type preference?",
            options: [
                { label: "Single Family", next: "buy_sfh_features" },
                { label: "Condo/Townhome", next: "buy_condo_check" },
                { label: "Multi-Unit", next: "strat_house_hack_invest" },
                { label: "Tiny Home / ADU", next: "strat_tiny_home" } // NEW
            ]
        },
        buy_sfh_features: {
            text: "Any specific needs?",
            options: [
                { label: "Multi-Generational", next: "strat_multigen_search" },
                { label: "Green/Solar", next: "strat_solar_check" },
                { label: "Eco/LEED Certified", next: "strat_green_mortgage" }, // NEW
                { label: "Standard", next: "strat_school_zone" }
            ]
        },
        buy_condo_check: {
            text: "Is the HOA healthy?",
            options: [ { label: "Yes/Unknown", next: "strat_condo_warrantable" }, { label: "No (Litigation)", next: "strat_non_warrantable" } ]
        },

        // --- REPEAT BUYER ---
        buy_repeat_triage: {
            text: "Sell current home first?",
            options: [ { label: "Yes", next: "buy_contingency" }, { label: "No", next: "buy_2nd_home" } ]
        },
        buy_contingency: {
            text: "Is it listed?",
            options: [ { label: "Yes", next: "strat_concurrent" }, { label: "No", next: "buy_equity_check" } ]
        },
        buy_equity_check: {
            text: "Equity > 30%?",
            options: [ { label: "Yes", next: "strat_bridge" }, { label: "No", next: "strat_sell_first" } ]
        },
        buy_2nd_home: {
            text: "Primary use?",
            options: [ { label: "Vacation", next: "strat_vacation" }, { label: "Investment", next: "strat_buy_hold" } ]
        },

        // ==========================================
        // BRANCH 2: SELLING
        // ==========================================
        sell_node_1: {
            text: "Is the property currently Occupied or Vacant?",
            options: [
                { label: "Occupied by Me", next: "sell_reason_check" },
                { label: "Occupied by Tenant", next: "sell_tenant_lease" },
                { label: "Vacant", next: "sell_vacant_issues" }, // NEW
                { label: "Hoarder Situation", next: "strat_hoarder_cleanout" } // NEW
            ]
        },
        sell_vacant_issues: { // NEW
            text: "Is the property winterized and insured as vacant?",
            options: [
                { label: "Yes, fully secured", next: "strat_vacant_staging" },
                { label: "No, utilities are off", next: "strat_utility_activation" }
            ]
        },
        sell_reason_check: {
            text: "Primary reason for selling?",
            options: [
                { label: "Upgrading / Downsizing", next: "sell_taxes_check" },
                { label: "Financial Distress / Debt", next: "sell_distress" },
                { label: "Divorce / Separation", next: "sell_divorce_status" },
                { label: "Inheritance / Probate", next: "sell_probate" }
            ]
        },
        sell_taxes_check: {
            text: "Lived there 2 of last 5 years?",
            options: [ { label: "Yes", next: "sell_title_check" }, { label: "No", next: "strat_cap_gains_calc" } ]
        },
        sell_title_check: {
            text: "Is the home in a Trust?",
            options: [ { label: "Yes", next: "strat_trust_sale" }, { label: "No", next: "sell_financial_status" } ]
        },
        sell_divorce_status: {
            text: "Amicable or Contested?",
            options: [ { label: "Amicable", next: "sell_financial_status" }, { label: "Contested", next: "strat_divorce_neutral" } ]
        },
        sell_financial_status: {
            text: "Equity Status?",
            options: [ { label: "Positive", next: "sell_retail_condition" }, { label: "Negative", next: "sell_distress" } ]
        },
        sell_retail_condition: {
            text: "Any known defects?",
            options: [
                { label: "Foundation Issues", next: "strat_structural_eng" }, // NEW
                { label: "Roof/HVAC Old", next: "strat_home_warranty" }, // NEW
                { label: "Unpermitted Work", next: "strat_retro_permit" },
                { label: "Good Condition", next: "sell_solar_check" }
            ]
        },
        sell_solar_check: { // NEW
            text: "Do you have Solar Panels?",
            options: [
                { label: "Yes, Leased", next: "strat_solar_lease_transfer" },
                { label: "Yes, Owned", next: "strat_green_marketing" },
                { label: "No", next: "sell_historic_check" }
            ]
        },
        sell_historic_check: { // NEW
            text: "Is the home in a Historic District?",
            options: [
                { label: "Yes, Historic/Landmark", next: "strat_historic_sale" },
                { label: "No", next: "sell_luxury_check" }
            ]
        },
        sell_tenant_lease: {
            text: "Lease Type?",
            options: [ { label: "Month-to-Month", next: "strat_concierge" }, { label: "Long Term", next: "strat_tenant_sale" }, { label: "Eviction needed", next: "strat_eviction_sale" } ]
        },
        sell_luxury_check: {
            text: "Value > $800k?",
            options: [ { label: "Yes", next: "sell_privacy_check" }, { label: "No", next: "strat_concierge" } ]
        },
        sell_privacy_check: {
            text: "Require privacy?",
            options: [ { label: "Yes", next: "strat_luxury_private" }, { label: "No", next: "strat_luxury_listing" } ]
        },
        // --- DISTRESS ---
        sell_distress: {
            text: "Any Liens?",
            options: [ { label: "Yes", next: "strat_title_clearance" }, { label: "No", next: "sell_mortgage_status" } ]
        },
        sell_mortgage_status: {
            text: "Behind on payments?",
            options: [ { label: "Yes", next: "sell_hardship" }, { label: "No", next: "strat_hold_rent" } ]
        },
        sell_hardship: {
            text: "Reverse Mortgage?",
            options: [ { label: "Yes", next: "strat_reverse_mortgage_sale" }, { label: "No", next: "sell_assets_check" } ]
        },
        sell_assets_check: {
            text: "Other Assets?",
            options: [ { label: "Yes", next: "strat_short_sale" }, { label: "No", next: "strat_deed_lieu" } ]
        },
        sell_probate: {
            text: "Letters of Office?",
            options: [ { label: "Yes", next: "sell_probate_heirs" }, { label: "No", next: "strat_probate_court" }, { label: "Unknown", next: "strat_probate_bond" } ]
        },
        sell_probate_heirs: {
            text: "Heirs agree?",
            options: [ { label: "Yes", next: "strat_probate_easy" }, { label: "No", next: "strat_probate_conflict" } ]
        },

        // ==========================================
        // BRANCH 3: REFINANCE
        // ==========================================
        refi_node_1: {
            text: "Primary Goal?",
            options: [
                { label: "Lower Payment", next: "refi_rate_check" },
                { label: "Cash Out", next: "refi_cash_reason" },
                { label: "Remove PMI", next: "refi_pmi_check" },
                { label: "Divorce Buyout", next: "strat_divorce_refi" } // NEW
            ]
        },
        refi_rate_check: {
            text: "Loan Type?",
            options: [ { label: "FHA/VA", next: "strat_streamline_refi" }, { label: "Conventional", next: "refi_credit_check" } ]
        },
        refi_credit_check: {
            text: "Score > 720?",
            options: [ { label: "Yes", next: "strat_rate_term_refi" }, { label: "No", next: "res_credit_repair" } ]
        },
        refi_cash_reason: {
            text: "Use of funds?",
            options: [
                { label: "Debt Consolidation", next: "strat_debt_consolidation" },
                { label: "Home Improvement", next: "strat_renovation_heloc" },
                { label: "Investment", next: "strat_cash_out_invest" },
                { label: "Buy 2nd Home", next: "strat_reverse_purchase" } // NEW
            ]
        },
        refi_pmi_check: {
            text: "Equity > 20%?",
            options: [ { label: "Yes", next: "strat_pmi_removal" }, { label: "Not sure", next: "strat_appraisal_gap" } ]
        },

        // ==========================================
        // BRANCH 4: INVESTING
        // ==========================================
        invest_node_1: {
            text: "Funding Source?",
            options: [
                { label: "Cash / Conventional", next: "inv_involvement" },
                { label: "Retirement Funds", next: "strat_sdir_custodian" }, // NEW
                { label: "1031 Exchange", next: "inv_1031_window" }
            ]
        },
        inv_involvement: {
            text: "Preferred involvement?",
            options: [ { label: "Active", next: "inv_experience" }, { label: "Passive", next: "inv_passive_check" } ]
        },
        inv_experience: {
            text: "Experience level?",
            options: [ { label: "Experienced", next: "inv_active_risk" }, { label: "Beginner", next: "inv_beginner_path" } ]
        },
        inv_beginner_path: {
            text: "Capital available?",
            options: [ { label: "Under $50k", next: "strat_house_hack_invest" }, { label: "$50k+", next: "strat_turnkey" } ]
        },
        inv_active_risk: {
            text: "Vehicle?",
            options: [
                { label: "Flip", next: "strat_fix_flip" },
                { label: "Long Term Rental", next: "inv_unit_count" },
                { label: "Airbnb", next: "inv_airbnb_check" },
                { label: "Wholesaling", next: "strat_wholesaling" }, // NEW
                { label: "Mobile Home Parks", next: "strat_mhp_invest" }, // NEW
                { label: "Storage Units", next: "strat_storage_invest" }, // NEW
                { label: "Student Housing", next: "strat_student_housing" }, // NEW
                { label: "Raw Land", next: "inv_land_check" }
            ]
        },
        inv_airbnb_check: {
            text: "Management style?",
            options: [ { label: "Self-Manage", next: "strat_str_self" }, { label: "Property Manager", next: "strat_str_managed" } ]
        },
        inv_land_check: {
            text: "Improved or Raw?",
            options: [ { label: "Improved", next: "strat_land_build" }, { label: "Raw", next: "inv_land_survey" } ]
        },
        inv_land_survey: {
            text: "Perc Test done?",
            options: [ { label: "Yes", next: "strat_land_hold" }, { label: "No", next: "strat_land_feasibility" } ]
        },
        inv_unit_count: {
            text: "Size?",
            options: [ { label: "2-4 Units", next: "strat_buy_hold" }, { label: "5+ Units", next: "strat_multifamily_commercial" } ]
        },
        inv_passive_check: {
            text: "Accredited?",
            options: [ { label: "Yes", next: "strat_syndication" }, { label: "No", next: "strat_reit" } ]
        },
        inv_1031_window: {
            text: "Sold <45 days ago?",
            options: [ { label: "Yes", next: "strat_dst" }, { label: "No", next: "strat_1031" } ]
        },

        // ==========================================
        // BRANCH 5: COMMERCIAL
        // ==========================================
        comm_node_1: {
            text: "Property Type?",
            options: [
                { label: "Retail/Restaurant", next: "comm_retail_node" },
                { label: "Office/Medical", next: "comm_office_node" },
                { label: "Industrial", next: "comm_industrial_node" },
                { label: "Gas Station/Auto", next: "comm_env_check" }
            ]
        },
        comm_env_check: {
            text: "Phase 1 Report?",
            options: [
                { label: "Clean", next: "strat_sba_504" },
                { label: "Dirty/Unknown", next: "strat_phase_2_env" } // NEW
            ]
        },
        comm_retail_node: {
            text: "Use?",
            options: [ { label: "Restaurant", next: "strat_restaurant_buy" }, { label: "Liquor Store", next: "strat_liquor_license" }, { label: "General", next: "comm_lease_own" } ] // NEW
        },
        comm_office_node: {
            text: "Use?",
            options: [ { label: "Medical", next: "comm_parking_check" }, { label: "General", next: "comm_lease_own" } ]
        },
        comm_parking_check: { // NEW
            text: "Does it meet 5:1000 Parking Ratio?",
            options: [ { label: "Yes", next: "strat_medical_office" }, { label: "No", next: "strat_parking_variance" } ]
        },
        comm_industrial_node: {
            text: "Requirement?",
            options: [ { label: "High Ceilings", next: "comm_crane_check" }, { label: "Loading Docks", next: "strat_industrial_logistics" } ]
        },
        comm_crane_check: { // NEW
            text: "Need Overhead Cranes?",
            options: [ { label: "Yes", next: "strat_heavy_manufacturing" }, { label: "No", next: "strat_flex_space" } ]
        },
        comm_lease_own: {
            text: "Strategy?",
            options: [ { label: "Buy", next: "strat_sba_504" }, { label: "Lease", next: "strat_lease_audit" }, { label: "Biz Only", next: "strat_biz_opp" } ]
        },

        // ==========================================
        // OUTCOMES
        // ==========================================
        
        // --- NEW OUTCOMES (Total now >90) ---
        strat_itin_loan: { text: "Strategy: ITIN Financing. For foreign nationals with an ITIN but no SSN. We need 15-20% down. Rates are higher, but qualification is based on ITIN tax returns or bank statements.", options: [] },
        strat_foreign_national: { text: "Strategy: Foreign National Loan. For non-residents with no US credit. We use a DSCR loan where the property's rental income qualifies the loan. Requires 25-30% down.", options: [] },
        strat_co_buy_agreement: { text: "Strategy: Co-Buying Agreement. Buying with a friend requires a formal legal agreement. We must title the home as 'Tenants in Common' so you can bequeath your share, unlike Joint Tenancy.", options: [] },
        strat_corp_relo: { text: "Strategy: Corporate Relocation Rider. Your company likely has a specific addendum. We must have their Relocation Counselor review the contract before you sign to protect your benefits.", options: [] },
        strat_tiny_home: { text: "Strategy: Tiny Home / ADU Zoning. Most towns forbid these on wheels. We must find land zoned for 'Accessory Dwelling Units' or unincorporated county land with looser restrictions.", options: [] },
        strat_green_mortgage: { text: "Strategy: Energy Efficient Mortgage (EEM). We can finance energy upgrades (windows, insulation) into the loan. The appraiser will account for the energy savings to boost your qualifying income.", options: [] },
        strat_hoarder_cleanout: { text: "Strategy: Discrete Cleanout Sale. We won't list photos yet. I will bring in a compassionate cleanout crew to empty the home, then we decide if we sell as-is to an investor or retail.", options: [] },
        strat_vacant_staging: { text: "Strategy: Virtual Staging. Vacant homes feel small and cold. We will physically stage the main rooms or use high-end Virtual Staging in photos to help buyers visualize the layout.", options: [] },
        strat_utility_activation: { text: "Strategy: Utility De-Winterization. Inspectors cannot test systems if utilities are off. We must activate water/gas/electric 3 days prior to inspection to avoid deal failure.", options: [] },
        strat_structural_eng: { text: "Strategy: Structural Engineer Report. Buyers will flee at the sight of cracks. We will pre-inspect with a Structural Engineer. If it's safe, his stamped letter will silence all buyer fears.", options: [] },
        strat_home_warranty: { text: "Strategy: Seller Coverage Warranty. We will buy a warranty during the listing period. It covers HVAC/Appliances if they break while listed, and transfers to the buyer at closing.", options: [] },
        strat_solar_lease_transfer: { text: "Strategy: Solar Lease Transfer. The buyer must qualify for both the mortgage AND the solar lease. We need to initiate the transfer paperwork with the solar company immediately.", options: [] },
        strat_historic_sale: { text: "Strategy: Historic Preservation Tax Freeze. We market the home's history. Illinois offers a Property Tax Assessment Freeze for owner-occupants who rehab historic homes. Huge selling point.", options: [] },
        strat_divorce_refi: { text: "Strategy: Owelty Lien / Divorce Buyout. We structure the refinance to pay out your ex-spouse's equity directly. This is treated as a Rate/Term refi (better rates) rather than Cash-Out.", options: [] },
        strat_reverse_purchase: { text: "Strategy: HECM for Purchase. If you are 62+, you can put ~50% down and finance the rest with a Reverse Mortgage. You have no monthly payments for life.", options: [] },
        strat_sdir_custodian: { text: "Strategy: Self-Directed IRA. You cannot buy this in your name. You must use a Custodian (e.g., Equity Trust). The contract is in the name of the IRA. All expenses/income must flow through the IRA.", options: [] },
        strat_wholesaling: { text: "Strategy: Wholesaling / Assignment. You are selling the *contract*, not the house. We need an 'And/Or Assigns' clause. We must verify local laws as Illinois requires a broker license for wholesaling.", options: [] },
        strat_mhp_invest: { text: "Strategy: Mobile Home Park. We analyze 'Pad Rent' vs 'Park Owned Homes'. We want to own the dirt, not the trailers. Focus on city water/sewer connections to reduce CAPEX risk.", options: [] },
        strat_student_housing: { text: "Strategy: Student Housing. We target properties within 1 mile of campus. Leases must be by the bedroom (Parental Guarantees required). Check city occupancy limits (e.g., 'Brothel Laws').", options: [] },
        strat_storage_invest: { text: "Strategy: Self-Storage. High margin, low headache. We focus on 'Climate Controlled' units in high-density areas. Automation (Kiosks) can reduce management costs to near zero.", options: [] },
        strat_phase_2_env: { text: "Strategy: Phase 2 Environmental. The Phase 1 found issues. We must now drill soil samples. If contamination exists, we negotiate a massive price reduction or walk away.", options: [] },
        strat_liquor_license: { text: "Strategy: Liquor License Transfer. The license is often worth more than the building. We must verify if the municipality allows the transfer or if the moratorium cap has been reached.", options: [] },
        strat_parking_variance: { text: "Strategy: Parking Variance. Medical use requires 5 spots per 1000sqft. This building has less. We must petition the zoning board for a variance or lease off-site parking nearby.", options: [] },
        strat_heavy_manufacturing: { text: "Strategy: Heavy Manufacturing. We need to verify floor load capacity for machines and bridge crane tonnage. We also check for 'drive-through' bays for semi-trucks.", options: [] },
        strat_ot_avg: { text: "Strategy: Overtime Averaging. Lenders average your OT over 2 years. If it is declining, they use the lower current year. We must provide a letter from your employer stating OT is likely to continue.", options: [] },
        strat_medical_collections: { text: "Strategy: Medical Debt Exclusion. Good news: Lenders treat medical collections differently. Conventional loans often ignore them. FHA may not require them to be paid off if they are under a certain amount.", options: [] },
        strat_green_marketing: { text: "Strategy: Green Premium Marketing. Owned solar adds value. We must use an appraiser certified in 'Green Addendums' to ensure they give you credit for the $30k+ system value.", options: [] },

        // --- RETAINED OUTCOMES ---
        strat_virtual_tour: { text: "Strategy: Virtual Relocation. Live video tours + Sight Unseen rider with 3-day rescission period.", options: [] },
        strat_jumbo_loan: { text: "Strategy: Jumbo Financing. Portfolio lenders for loans over $766k.", options: [] },
        strat_usda_loan: { text: "Strategy: USDA Rural Development. 0% down in eligible rural areas.", options: [] },
        strat_fsbo_conversion: { text: "Strategy: MLS Exposure Plan. Unlock the 97% of buyers represented by agents.", options: [] },
        strat_expired_relist: { text: "Strategy: Fresh Market Refresh. New photos, new price, new description.", options: [] },
        strat_cap_gains_calc: { text: "Strategy: Tax Deferred Analysis. Calculate 1031 Exchange vs Capital Gains tax.", options: [] },
        strat_private_showings: { text: "Strategy: Appointment-Only. No open houses, strict vetting of buyers.", options: [] },
        strat_str_self: { text: "Strategy: Self-Managed Airbnb. Automate cleaning and messaging to keep revenue high.", options: [] },
        strat_str_managed: { text: "Strategy: Managed STR. Pay 20% for passive income. Underwrite accordingly.", options: [] },
        strat_land_build: { text: "Strategy: Construction-to-Perm Loan. Buy the lot and build with one closing.", options: [] },
        strat_zoning_attorney: { text: "Strategy: Zoning Contingency. Offer contingent on Special Use Permit approval.", options: [] },
        strat_biz_opp: { text: "Strategy: Business Asset Sale. Audit P&L and buy the cash flow, not the real estate.", options: [] },
        strat_bank_statement: { text: "Strategy: Bank Statement Loan. Qualify using 12mo deposits instead of tax returns.", options: [] },
        strat_physician_loan: { text: "Strategy: Physician Loan. Exclude student debt from DTI, low down payment.", options: [] },
        strat_manual_underwriting: { text: "Strategy: Manual Underwriting. Manual review of rent/utility history for credit approval.", options: [] },
        strat_hard_money_buy: { text: "Strategy: Hard Money Bridge. Secure property now, refinance later.", options: [] },
        strat_new_construction: { text: "Strategy: Builder Representation. Negotiate upgrades and pre-drywall inspections.", options: [] },
        strat_divorce_neutral: { text: "Strategy: Neutral Third-Party Sale. Unbiased representation for contested divorce sales.", options: [] },
        strat_senior_transition: { text: "Strategy: Rightsizing. Coordinate estate sales and move to 55+ community.", options: [] },
        strat_luxury_private: { text: "Strategy: Private Placement. Off-market sale to high-net-worth network.", options: [] },
        strat_eviction_sale: { text: "Strategy: Cash-for-Keys. Pay tenant to leave to ensure a clean sale.", options: [] },
        strat_probate_conflict: { text: "Strategy: Mediator Sale. Transparent offer presentation to all heirs.", options: [] },
        strat_house_hack_invest: { text: "Strategy: House Hack. FHA 3.5% down on 2-4 unit property.", options: [] },
        strat_multifamily_commercial: { text: "Strategy: DSCR Loan. Loan based on property income, not personal DTI.", options: [] },
        strat_restaurant_buy: { text: "Strategy: 2nd Gen Restaurant. Buy existing hood/grease trap to save capital.", options: [] },
        strat_medical_office: { text: "Strategy: TI Negotiation. Get landlord to pay for plumbing/buildout.", options: [] },
        strat_flex_space: { text: "Strategy: Flex Space. Rear loading + front office in business park.", options: [] },
        strat_commuter_hub: { text: "Strategy: Transit-Oriented. Buy within walking distance of Train.", options: [] },
        strat_school_zone: { text: "Strategy: District Search. Filter strictly by school rating boundaries.", options: [] },
        strat_va_loan: { text: "Strategy: VA Loan. 0% down, no PMI for veterans.", options: [] },
        strat_203k_rehab: { text: "Strategy: FHA 203k. Purchase + Rehab costs in one loan.", options: [] },
        res_grant: { text: "Strategy: Down Payment Assistance. IHDA grants for cash-to-close.", options: [] },
        res_fha_standard: { text: "Strategy: FHA 3.5%. Low down payment for scores 620+.", options: [] },
        res_credit_repair: { text: "Strategy: Credit Roadmap. Pause search to fix DTI and score.", options: [] },
        strat_concurrent: { text: "Strategy: Concurrent Closing. Sell AM, Buy PM.", options: [] },
        strat_bridge: { text: "Strategy: Bridge Loan. Use current equity to buy next home first.", options: [] },
        strat_sell_first: { text: "Strategy: Home of Choice Contingency. Sell first, but only if you find a home.", options: [] },
        strat_vacation: { text: "Strategy: STR Analysis. Verify ROI and local regulations.", options: [] },
        strat_leaseback: { text: "Strategy: Rent-Back. Stay in home 60 days after selling.", options: [] },
        strat_luxury_listing: { text: "Strategy: Lifestyle Marketing. Global syndication and high-end media.", options: [] },
        strat_tenant_sale: { text: "Strategy: Cap Rate Sale. Market cash flow to investors.", options: [] },
        strat_concierge: { text: "Strategy: Concierge Listing. Staging and prep for max price.", options: [] },
        strat_instant: { text: "Strategy: Instant Offer. Speed over price.", options: [] },
        strat_hold_rent: { text: "Strategy: Rent & Hold. Wait for equity to recover.", options: [] },
        strat_short_sale: { text: "Strategy: Short Sale. Negotiate debt forgiveness with bank.", options: [] },
        strat_deed_lieu: { text: "Strategy: Deed in Lieu. Voluntary foreclosure to save time.", options: [] },
        strat_probate_easy: { text: "Strategy: Independent Admin. Fast probate sale.", options: [] },
        strat_probate_court: { text: "Strategy: Court Approval. 60-day closing for judge sign-off.", options: [] },
        strat_probate_bond: { text: "Strategy: Bond in Lieu. Sell before probate ends.", options: [] },
        strat_turnkey: { text: "Strategy: Turnkey. Buy renovated/tenanted property.", options: [] },
        strat_dst: { text: "Strategy: DST 1031. Passive replacement property.", options: [] },
        strat_fix_flip: { text: "Strategy: 70% Rule. Buy deep discount for rehab.", options: [] },
        strat_brrrr: { text: "Strategy: BRRRR. Refinance to pull capital out.", options: [] },
        strat_buy_hold: { text: "Strategy: Cash Flow. 2-4 units for long term wealth.", options: [] },
        strat_syndication: { text: "Strategy: Syndication LP. Passive commercial investing.", options: [] },
        strat_reit: { text: "Strategy: REIT. Liquid real estate stock.", options: [] },
        strat_hold_refi: { text: "Strategy: Cash-Out Refi. Buy more assets with equity.", options: [] },
        strat_1031: { text: "Strategy: 1031 Exchange. Defer taxes on sale.", options: [] },
        strat_sba_504: { text: "Strategy: SBA 504. 10% down for business owners.", options: [] },
        strat_lease_audit: { text: "Strategy: NNN Audit. Check CAM charges.", options: [] },
        strat_lease_base_year: { text: "Strategy: Base Year Stop. Cap expense increases.", options: [] },
        strat_industrial_logistics: { text: "Strategy: Logistics Focus. 14ft doors and highway access.", options: [] },
        res_conventional_check: { text: "Strategy: Conventional Loan. 3-5% down, PMI drops off.", options: [] },
        strat_streamline_refi: { text: "Strategy: FHA/VA Streamline. Low doc refi, no appraisal.", options: [] },
        strat_rate_term_refi: { text: "Strategy: Rate & Term Refi. Lower monthly payment, keep equity.", options: [] },
        strat_debt_consolidation: { text: "Strategy: Debt Consolidation. Pay off high interest cards.", options: [] },
        strat_renovation_heloc: { text: "Strategy: HELOC. Renovation funds without touching main rate.", options: [] },
        strat_cash_out_invest: { text: "Strategy: Cash Out Invest. Use equity for down payment on rental.", options: [] },
        strat_pmi_removal: { text: "Strategy: PMI Removal. Appraise to prove 20% equity.", options: [] },
        strat_appraisal_gap: { text: "Strategy: Appraisal Gap Analysis. Verify value before refinancing.", options: [] },
        strat_fha_ibr: { text: "Strategy: FHA IBR. Use Income Based Repayment for student loans.", options: [] },
        strat_conventional_1percent: { text: "Strategy: Conventional Student Loan. Count 1% of balance.", options: [] },
        strat_cosigner_fha: { text: "Strategy: Non-Occupying Co-Borrower. Blend income with relative.", options: [] },
        strat_good_neighbor: { text: "Strategy: Hero Programs. Grants for Teachers/Fire/Police.", options: [] },
        strat_condo_warrantable: { text: "Strategy: Warrantable Condo. Standard rates for healthy HOA.", options: [] },
        strat_non_warrantable: { text: "Strategy: Non-Warrantable. Portfolio loan for litigation condos.", options: [] },
        strat_solar_check: { text: "Strategy: Solar Lease Check. Verify transferability of panels.", options: [] },
        strat_multigen_search: { text: "Strategy: Multi-Gen. Target in-law suites and 1st floor beds.", options: [] },
        strat_rsu_income: { text: "Strategy: RSU Income. Use vesting schedule for tech income.", options: [] },
        strat_asset_depletion: { text: "Strategy: Asset Depletion. Use assets as phantom income.", options: [] },
        strat_remove_disputes: { text: "Strategy: Dispute Removal. Clear credit report for mortgage.", options: [] },
        strat_gift_letter: { text: "Strategy: Gift Letter. Document down payment gift properly.", options: [] },
        strat_trust_sale: { text: "Strategy: Trust Sale. Certificate of Trust required.", options: [] },
        strat_retro_permit: { text: "Strategy: Retroactive Permit. Legalize unpermitted work.", options: [] },
        strat_title_clearance: { text: "Strategy: Title Clearance. Check for liens before listing.", options: [] },
        strat_reverse_mortgage_sale: { text: "Strategy: HECM Payoff. Coordinate payoff immediately.", options: [] },
        strat_phase_1_env: { text: "Strategy: Phase 1 Enviro. Check soil for contamination.", options: [] },
        strat_heavy_industrial: { text: "Strategy: Heavy Power. Find existing 3-Phase electric.", options: [] },
        strat_mid_term_rental: { text: "Strategy: Mid-Term Rental. Housing for traveling nurses.", options: [] },
        strat_section_8: { text: "Strategy: Section 8. Guaranteed government rent.", options: [] },
        strat_land_feasibility: { text: "Strategy: Land Feasibility. Perc test required for septic.", options: [] }
    };

    let currentNode = 'start';
    let history = []; 
    let pathLabels = []; 

    const elements = {
        question: document.getElementById('question-text'),
        options: document.getElementById('options-container'),
        backBtn: document.getElementById('back-btn'),
        progress: document.getElementById('progress-bar-fill'),
        step: document.getElementById('step-counter'),
        formContainer: document.getElementById('contact-form-container'),
        message: document.getElementById('message-field')
    };

    function renderNode() {
        const node = tree[currentNode];
        if(!node) {
            console.error("Node not found:", currentNode);
            return;
        }

        elements.question.innerText = node.text;
        elements.options.innerHTML = '';
        
        const isResult = node.options.length === 0;
        const stepCount = history.length + 1;
        
        elements.step.innerText = isResult ? 'Recommendation Found' : `Step ${stepCount}`;
        elements.progress.style.width = isResult ? '100%' : Math.min(stepCount * 5, 95) + '%';
        elements.backBtn.style.display = (history.length > 0) ? 'block' : 'none';

        if (isResult) {
            elements.question.classList.add('result-card');
            elements.formContainer.style.display = 'block';
            
            let complianceNote = "\n\n*Local Compliance Note (Villa Park/IL):* \n- Transfer Stamps: $0 (Villa Park), but Inspection Required ($50).\n- Mandatory Disclosures: IL Radon, Lead-Based Paint (Pre-1978).";
            elements.message.value = "Client Path: " + pathLabels.join(" > ") + "\n\nGenerated Strategy: " + node.text + complianceNote;
            
            const restartBtn = document.createElement('button');
            restartBtn.innerText = "Start Over / Try Another Scenario";
            restartBtn.className = "tree-option-btn";
            restartBtn.style.textAlign = "center";
            restartBtn.style.marginTop = "20px";
            restartBtn.style.background = "#fff";
            restartBtn.onclick = () => { 
                history = []; 
                pathLabels = []; 
                currentNode = 'start'; 
                renderNode(); 
            };
            elements.options.appendChild(restartBtn);
        } else {
            elements.question.classList.remove('result-card');
            elements.formContainer.style.display = 'none';
            node.options.forEach(opt => {
                const btn = document.createElement('button');
                btn.innerText = opt.label;
                btn.className = "tree-option-btn";
                btn.onclick = () => {
                    history.push(currentNode);
                    pathLabels.push(opt.label);
                    currentNode = opt.next;
                    renderNode();
                };
                elements.options.appendChild(btn);
            });
        }
    }

    elements.backBtn.onclick = () => {
        if (history.length > 0) {
            currentNode = history.pop();
            pathLabels.pop();
            renderNode();
        }
    };

    renderNode();
});
</script>
</body>
</html>
