<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Pavlo Rospopa Expert Strategy Engine</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/format.css">
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>

    <style>
        body { -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f7f9; }
        input, textarea { -webkit-user-select: text; -moz-user-select: text; -ms-user-select: text; user-select: text; }

        #real-estate-guide-container {
            margin: 40px auto; padding: 30px; border: 1px solid #e0e0e0; border-radius: 12px;
            background-color: #ffffff; box-shadow: 0 4px 15px rgba(0,0,0,0.05); position: relative; z-index: 101;
            max-width: 950px;
        }
        .tree-option-btn {
            padding: 12px 16px; background-color: #f8f9fa; color: #333; border: 2px solid #eef0f2;
            border-radius: 8px; cursor: pointer; font-size: 0.95rem; text-align: left;
            transition: all 0.2s; font-weight: 500; width: 100%; margin-bottom: 6px; display: block;
        }
        .tree-option-btn:hover { border-color: #4285F4; color: #4285F4; transform: translateX(4px); }
        .result-card { background: #f4f7ff; border-left: 6px solid #4285F4; padding: 25px; border-radius: 8px; color: #334155; line-height: 1.7; margin-bottom: 20px; }

        #contact-form-container { margin: 40px 0; padding: 20px; border: 1px solid #e0e0e0; border-radius: 8px; background-color: #f9f9f9; }
        #contact-form { display: flex; flex-direction: column; gap: 15px; }
        #contact-form input, #contact-form textarea { padding: 12px; border: 1px solid #ccc; border-radius: 4px; width: 100%; box-sizing: border-box; }
        #contact-form button { padding: 12px 24px; background-color: #333; color: white; border: none; border-radius: 4px; cursor: pointer; align-self: flex-start; font-weight: bold; }
        #contact-form button:hover { background-color: #555; }
        
        .progress-container { width: 100%; height: 8px; background: #eee; border-radius: 4px; margin: 15px 0; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #4285F4, #34a853); transition: width 0.3s ease; }
    </style>
</head>
     
<body>

<header class="site-header">
    <div class="wrap" style="text-align: center; padding: 20px 0;">
        <a class="site-title" style="text-decoration: none; font-size: 2rem; color: #333; font-weight: 800;" href="https://rospopa.com">Pavlo Rospopa Strategy Engine</a>
    </div>
</header>

<main>
    <div class="page-content">
        <div class="wrap">
            <div id="real-estate-guide-container">
                
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <button id="back-btn" style="background:none; border:none; color:#4285F4; cursor:pointer; font-weight:bold; display:none;">‚Üê Back</button>
                    <span id="step-counter" style="color:#888; font-size:0.9rem;">Start</span>
                </div>
                
                <div class="progress-container">
                    <div id="progress-bar-fill" class="progress-fill" style="width: 1%;"></div>
                </div>

                <div id="tree-content">
                    <h2 id="question-text" style="margin-bottom: 25px; font-size: 1.4rem; color: #222; font-weight: 700;">Loading Logic...</h2>
                    <div id="options-container"></div>
                </div>

                <div id="contact-form-container" style="display: none;">
                    <h3 style="margin-top:0;">Request This Strategy</h3>
                    <p style="font-size: 0.9rem; color: #666; margin-bottom: 15px;">Based on your answers, this is the most efficient path forward.</p>
                    <form id="contact-form">
                        <input type="text" name="name" placeholder="Your Name" required />
                        <input type="email" name="email" placeholder="Your Email" required />
                        <input type="tel" name="phone" placeholder="Phone Number (Optional)" />
                        <textarea id="message-field" name="message" rows="5" required></textarea>
                        <div class="g-recaptcha" data-sitekey="6Let_E8sAAAAAP948s5QuqjQ-HKYRuoXxLzILZ9p"></div>
                        <button type="submit" id="submit-btn">Send Request</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</main>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const tree = {
        // --- ROOT ---
        start: {
            text: "What is your primary Real Estate Goal?",
            options: [
                { label: "Residential: Buying", next: "buy_node_1" },
                { label: "Residential: Selling", next: "sell_node_1" },
                { label: "Refinancing / Mortgage", next: "refi_node_1" },
                { label: "Wealth: Investing", next: "invest_node_1" },
                { label: "Commercial / Business", next: "comm_node_1" },
                { label: "Land / Development", next: "land_node_1" } // NEW BRANCH
            ]
        },

        // ==========================================
        // BRANCH 1: BUYING
        // ==========================================
        buy_node_1: {
            text: "Are you a US Citizen or Permanent Resident?",
            options: [
                { label: "Yes", next: "buy_loc_status" },
                { label: "No (Visa/Foreign National)", next: "buy_visa_status" }
            ]
        },
        buy_visa_status: { 
            text: "Do you have a valid Work Visa or ITIN?",
            options: [
                { label: "Work Visa (H1B, etc)", next: "buy_loc_status" },
                { label: "ITIN Number only", next: "strat_itin_loan" },
                { label: "Foreign National (No US Credit)", next: "strat_foreign_national" }
            ]
        },
        buy_loc_status: {
            text: "Are you buying locally or relocating?",
            options: [
                { label: "Buying Locally", next: "buy_co_buy_check" },
                { label: "Relocating", next: "buy_relo_timeline" }
            ]
        },
        buy_relo_timeline: {
            text: "Is this a Corporate Move or Self-Move?",
            options: [
                { label: "Corporate Package", next: "strat_corp_relo" },
                { label: "Self-Move / Job Change", next: "buy_job_gap_check" } // Updated
            ]
        },
        buy_job_gap_check: { // NEW
            text: "Will you have a gap in employment during the move?",
            options: [
                { label: "No, immediate start", next: "strat_virtual_tour" },
                { label: "Yes, >30 days gap", next: "strat_employment_gap_letter" }
            ]
        },
        buy_co_buy_check: {
            text: "Who are you buying with?",
            options: [
                { label: "Just me / Spouse", next: "buy_history_check" },
                { label: "Unmarried Partner / Friend", next: "strat_co_buy_agreement" },
                { label: "Parent / Co-Signer", next: "strat_cosigner_fha" }
            ]
        },
        buy_history_check: {
            text: "Have you owned a home in the last 3 years?",
            options: [
                { label: "No (First-Time Buyer)", next: "buy_fthb_triage" },
                { label: "Yes (Repeat Buyer)", next: "buy_repeat_triage" }
            ]
        },
        
        // --- FTHB PATH ---
        buy_fthb_triage: {
            text: "What is your biggest hurdle right now?",
            options: [
                { label: "Down Payment", next: "buy_down_source" },
                { label: "Credit Score", next: "buy_credit_deep" },
                { label: "Income / Debt", next: "buy_income_check" },
                { label: "Inventory Strategy", next: "buy_inventory_triage" }
            ]
        },
        // --- INCOME & DEBT ---
        buy_income_check: {
            text: "Do you have significant Student Loan debt?",
            options: [
                { label: "Yes, Student Loans", next: "buy_student_loan_calc" },
                { label: "No, other debt/income issues", next: "buy_income_type" }
            ]
        },
        buy_student_loan_calc: {
            text: "Are you on an Income-Based Repayment (IBR) plan?",
            options: [
                { label: "Yes, IBR Plan", next: "strat_fha_ibr" },
                { label: "No, Standard Plan", next: "strat_conventional_1percent" }
            ]
        },
        buy_income_type: {
            text: "How is your income derived?",
            options: [
                { label: "W-2 Salary", next: "buy_overtime_check" },
                { label: "Self-Employed", next: "buy_self_emp_years" },
                { label: "Commission/Bonus", next: "buy_variable_income" },
                { label: "Tip Income", next: "buy_tip_income" }
            ]
        },
        buy_tip_income: {
            text: "Do you report all your tips to the IRS?",
            options: [
                { label: "Yes, fully reported", next: "res_fha_standard" },
                { label: "No, mostly cash", next: "strat_bank_statement" }
            ]
        },
        buy_overtime_check: {
            text: "Do you rely on Overtime pay to qualify?",
            options: [
                { label: "Yes, need OT income", next: "strat_ot_avg" },
                { label: "No, Base Salary is enough", next: "res_fha_standard" }
            ]
        },
        buy_variable_income: {
            text: "Do you have a 2-year history of this variable income?",
            options: [
                { label: "Yes, consistent", next: "res_conventional_check" },
                { label: "No, it varies", next: "strat_base_income_only" }
            ]
        },
        buy_self_emp_years: {
            text: "Do your tax returns show strong net income?",
            options: [
                { label: "Yes, I show profit", next: "res_conventional_check" },
                { label: "No, high write-offs", next: "strat_bank_statement" }
            ]
        },
        // --- CREDIT ---
        buy_credit_deep: {
            text: "Approximate Credit Score?",
            options: [
                { label: "Excellent (720+)", next: "res_conventional_check" },
                { label: "Good (620-719)", next: "res_fha_standard" },
                { label: "Fair (580-619)", next: "buy_credit_issues" },
                { label: "Poor (<580)", next: "res_credit_repair" }
            ]
        },
        buy_credit_issues: {
            text: "Any open disputes or collections?",
            options: [
                { label: "Yes, Disputes", next: "strat_remove_disputes" },
                { label: "Bankruptcy <2 years", next: "strat_hard_money_buy" },
                { label: "Medical Collections", next: "strat_medical_collections" }
            ]
        },
        // --- DOWN PAYMENT ---
        buy_down_source: {
            text: "Are you a Veteran?",
            options: [ { label: "Yes", next: "buy_va_check" }, { label: "No", next: "buy_rural_check" } ]
        },
        buy_va_check: {
            text: "Do you have full entitlement available?",
            options: [ { label: "Yes / First Use", next: "buy_va_disability" }, { label: "No / Subsequent Use", next: "strat_va_bonus_entitlement" } ]
        },
        buy_va_disability: {
            text: "Do you have a service-connected disability rating?",
            options: [ { label: "Yes (10%+)", next: "strat_va_fee_waiver" }, { label: "No", next: "strat_va_loan" } ]
        },
        buy_rural_check: {
            text: "Willing to buy Rural?",
            options: [ { label: "Yes", next: "strat_usda_loan" }, { label: "No", next: "buy_gift_check" } ]
        },
        buy_gift_check: {
            text: "Do you have gift funds?",
            options: [ { label: "Yes", next: "buy_gift_seasoning" }, { label: "No", next: "res_grant" } ]
        },
        buy_gift_seasoning: {
            text: "Are the funds currently in your bank account?",
            options: [ { label: "Yes, >60 days", next: "res_conventional_check" }, { label: "No, wiring later", next: "strat_gift_letter" } ]
        },
        // --- INVENTORY & OFFER STRATEGY ---
        buy_inventory_triage: {
            text: "Property Type preference?",
            options: [
                { label: "Single Family", next: "buy_sfh_features" },
                { label: "Condo/Townhome", next: "buy_condo_check" },
                { label: "Multi-Unit", next: "strat_house_hack_invest" },
                { label: "New Construction", next: "buy_new_build_check" }
            ]
        },
        buy_new_build_check: { // NEW
            text: "Custom or Tract Home?",
            options: [
                { label: "Tract (Subdivision)", next: "strat_builder_reg" },
                { label: "Custom (My Lot)", next: "strat_construction_loan" }
            ]
        },
        buy_sfh_features: {
            text: "Any specific needs?",
            options: [
                { label: "Multi-Generational", next: "strat_multigen_search" },
                { label: "Green/Solar", next: "strat_solar_check" },
                { label: "Pool", next: "strat_pool_inspection" }, // NEW
                { label: "Standard", next: "buy_offer_market" }
            ]
        },
        buy_offer_market: {
            text: "How competitive is the market right now?",
            options: [
                { label: "Bidding Wars", next: "buy_aggressive_offer" },
                { label: "Balanced/Slow", next: "buy_inspection_pref" }
            ]
        },
        buy_aggressive_offer: {
            text: "Are you willing to cover an Appraisal Gap?",
            options: [
                { label: "Yes, I have extra cash", next: "strat_appraisal_gap_guarantee" },
                { label: "No, max budget", next: "strat_escalation_clause" }
            ]
        },
        buy_inspection_pref: {
            text: "Inspection preferences?",
            options: [
                { label: "Info Only (Pass/Fail)", next: "strat_info_only_inspection" },
                { label: "Full Negotiation", next: "buy_age_check" }
            ]
        },
        buy_age_check: {
            text: "Are you looking at homes built before 1978?",
            options: [
                { label: "Yes (Vintage)", next: "strat_lead_paint" },
                { label: "No (Modern)", next: "buy_system_check" }
            ]
        },
        buy_system_check: {
            text: "Water/Sewer Source?",
            options: [
                { label: "Public/City", next: "strat_sewer_scope" },
                { label: "Private Well/Septic", next: "strat_septic_inspection" }
            ]
        },
        buy_condo_check: {
            text: "Is the HOA healthy?",
            options: [ { label: "Yes/Unknown", next: "strat_condo_warrantable" }, { label: "No (Litigation)", next: "strat_non_warrantable" } ]
        },

        // --- REPEAT BUYER ---
        buy_repeat_triage: {
            text: "Sell current home first?",
            options: [ { label: "Yes", next: "buy_contingency" }, { label: "No", next: "buy_2nd_home" } ]
        },
        buy_contingency: {
            text: "Is it listed?",
            options: [ { label: "Yes", next: "strat_concurrent" }, { label: "No", next: "buy_equity_check" } ]
        },
        buy_equity_check: {
            text: "Equity > 30%?",
            options: [ { label: "Yes", next: "strat_bridge" }, { label: "No", next: "strat_sell_first" } ]
        },
        buy_2nd_home: {
            text: "Primary use?",
            options: [ { label: "Vacation", next: "strat_vacation" }, { label: "Investment", next: "strat_buy_hold" } ]
        },

        // ==========================================
        // BRANCH 2: SELLING (Deep Dive)
        // ==========================================
        sell_node_1: {
            text: "Is the property currently Occupied or Vacant?",
            options: [
                { label: "Occupied by Me", next: "sell_pets_check" },
                { label: "Occupied by Tenant", next: "sell_tenant_lease" },
                { label: "Vacant", next: "sell_vacant_issues" },
                { label: "Hoarder Situation", next: "strat_hoarder_cleanout" }
            ]
        },
        sell_pets_check: {
            text: "Do you have pets in the home?",
            options: [
                { label: "Yes", next: "strat_pet_showing_plan" },
                { label: "No", next: "sell_reason_check" }
            ]
        },
        sell_vacant_issues: {
            text: "Is the property winterized and insured as vacant?",
            options: [
                { label: "Yes, fully secured", next: "strat_vacant_staging" },
                { label: "No, utilities are off", next: "strat_utility_activation" }
            ]
        },
        sell_reason_check: {
            text: "Primary reason for selling?",
            options: [
                { label: "Upgrading / Downsizing", next: "sell_taxes_check" },
                { label: "Financial Distress / Debt", next: "sell_distress" },
                { label: "Divorce / Separation", next: "sell_divorce_status" },
                { label: "Inheritance / Probate", next: "sell_probate" }
            ]
        },
        sell_taxes_check: {
            text: "Lived there 2 of last 5 years?",
            options: [ { label: "Yes", next: "sell_title_check" }, { label: "No", next: "strat_cap_gains_calc" } ]
        },
        sell_title_check: {
            text: "Is the home in a Trust?",
            options: [ { label: "Yes", next: "strat_trust_sale" }, { label: "No", next: "sell_financial_status" } ]
        },
        sell_divorce_status: {
            text: "Amicable or Contested?",
            options: [ { label: "Amicable", next: "sell_title_transfer" }, { label: "Contested", next: "strat_divorce_neutral" } ]
        },
        sell_title_transfer: {
            text: "Are you selling or is one spouse keeping it?",
            options: [ { label: "Selling", next: "sell_financial_status" }, { label: "Spouse Keeping", next: "strat_quit_claim" } ]
        },
        sell_financial_status: {
            text: "Equity Status?",
            options: [ { label: "Positive", next: "sell_retail_condition" }, { label: "Negative", next: "sell_distress" } ]
        },
        sell_retail_condition: {
            text: "Any known defects?",
            options: [
                { label: "Foundation Issues", next: "strat_structural_eng" },
                { label: "Roof/HVAC Old", next: "strat_home_warranty" },
                { label: "Unpermitted Work", next: "strat_retro_permit" },
                { label: "Good Condition", next: "sell_solar_check" }
            ]
        },
        sell_solar_check: {
            text: "Do you have Solar Panels?",
            options: [
                { label: "Yes, Leased", next: "strat_solar_lease_transfer" },
                { label: "Yes, Owned", next: "strat_green_marketing" },
                { label: "No", next: "sell_historic_check" }
            ]
        },
        sell_historic_check: {
            text: "Is the home in a Historic District?",
            options: [
                { label: "Yes, Historic/Landmark", next: "strat_historic_sale" },
                { label: "No", next: "sell_stigma_check" } // NEW
            ]
        },
        sell_stigma_check: { // NEW
            text: "Are there any 'Stigmatized' issues (Death/Crime)?",
            options: [
                { label: "Yes", next: "strat_stigma_disclosure" },
                { label: "No", next: "sell_luxury_check" }
            ]
        },
        sell_tenant_lease: {
            text: "Lease Type?",
            options: [ { label: "Month-to-Month", next: "strat_cash_keys_coop" }, { label: "Long Term", next: "strat_tenant_sale" }, { label: "Eviction needed", next: "strat_eviction_sale" } ]
        },
        sell_luxury_check: {
            text: "Value > $800k?",
            options: [ { label: "Yes", next: "sell_privacy_check" }, { label: "No", next: "strat_concierge" } ]
        },
        sell_privacy_check: {
            text: "Require privacy?",
            options: [ { label: "Yes", next: "strat_luxury_private" }, { label: "No", next: "strat_luxury_listing" } ]
        },
        // --- DISTRESS ---
        sell_distress: {
            text: "Any Liens?",
            options: [ { label: "Yes", next: "strat_title_clearance" }, { label: "No", next: "sell_mortgage_status" } ]
        },
        sell_mortgage_status: {
            text: "Behind on payments?",
            options: [ { label: "Yes", next: "sell_hardship" }, { label: "No", next: "strat_hold_rent" } ]
        },
        sell_hardship: {
            text: "Reverse Mortgage?",
            options: [ { label: "Yes", next: "strat_reverse_mortgage_sale" }, { label: "No", next: "sell_assets_check" } ]
        },
        sell_assets_check: {
            text: "Other Assets?",
            options: [ { label: "Yes", next: "strat_short_sale" }, { label: "No", next: "strat_deed_lieu" } ]
        },
        sell_probate: {
            text: "Letters of Office?",
            options: [ { label: "Yes", next: "sell_probate_type" }, { label: "No", next: "strat_probate_court" }, { label: "Unknown", next: "strat_probate_bond" } ]
        },
        sell_probate_type: {
            text: "Is there a Will?",
            options: [ { label: "Yes", next: "strat_probate_easy" }, { label: "No (Intestate)", next: "strat_probate_intestate" } ]
        },

        // ==========================================
        // BRANCH 3: REFINANCE
        // ==========================================
        refi_node_1: {
            text: "Primary Goal?",
            options: [
                { label: "Lower Payment", next: "refi_rate_check" },
                { label: "Cash Out", next: "refi_cash_reason" },
                { label: "Remove PMI", next: "refi_pmi_check" },
                { label: "Divorce Buyout", next: "strat_divorce_refi" }
            ]
        },
        refi_rate_check: {
            text: "Loan Type?",
            options: [ { label: "FHA/VA", next: "strat_streamline_refi" }, { label: "Conventional", next: "refi_credit_check" } ]
        },
        refi_credit_check: {
            text: "Score > 720?",
            options: [ { label: "Yes", next: "strat_rate_term_refi" }, { label: "No", next: "res_credit_repair" } ]
        },
        refi_cash_reason: {
            text: "Use of funds?",
            options: [
                { label: "Debt Consolidation", next: "strat_debt_consolidation" },
                { label: "Home Improvement", next: "refi_renovation_style" },
                { label: "Investment", next: "strat_cash_out_invest" },
                { label: "Buy 2nd Home", next: "strat_reverse_purchase" }
            ]
        },
        refi_renovation_style: {
            text: "Loan Preference?",
            options: [
                { label: "Keep current rate (HELOC)", next: "strat_renovation_heloc" },
                { label: "Refinance all (Cash-Out)", next: "strat_cash_out_refi" }
            ]
        },
        refi_pmi_check: {
            text: "Equity > 20%?",
            options: [ { label: "Yes", next: "strat_pmi_removal" }, { label: "Not sure", next: "strat_appraisal_gap" } ]
        },

        // ==========================================
        // BRANCH 4: INVESTING
        // ==========================================
        invest_node_1: {
            text: "Funding Source?",
            options: [
                { label: "Cash / Conventional", next: "inv_creative_check" },
                { label: "Retirement Funds", next: "strat_sdir_custodian" },
                { label: "1031 Exchange", next: "inv_1031_window" }
            ]
        },
        inv_creative_check: {
            text: "Interested in Creative Financing?",
            options: [
                { label: "Yes (Sub2 / Seller Fin)", next: "inv_creative_type" },
                { label: "No, Standard Bank Loan", next: "inv_involvement" }
            ]
        },
        inv_creative_type: {
            text: "Preferred Method?",
            options: [
                { label: "Subject-To (Take over payments)", next: "strat_subject_to" },
                { label: "Seller Financing", next: "strat_seller_finance" },
                { label: "Lease Option", next: "strat_lease_option" }
            ]
        },
        inv_involvement: {
            text: "Preferred involvement?",
            options: [ { label: "Active", next: "inv_experience" }, { label: "Passive", next: "inv_passive_check" } ]
        },
        inv_experience: {
            text: "Experience level?",
            options: [ { label: "Experienced", next: "inv_active_risk" }, { label: "Beginner", next: "inv_beginner_path" } ]
        },
        inv_beginner_path: {
            text: "Capital available?",
            options: [ { label: "Under $50k", next: "strat_house_hack_invest" }, { label: "$50k+", next: "strat_turnkey" } ]
        },
        inv_active_risk: {
            text: "Vehicle?",
            options: [
                { label: "Flip", next: "strat_fix_flip" },
                { label: "Long Term Rental", next: "inv_unit_count" },
                { label: "Airbnb", next: "inv_airbnb_check" },
                { label: "Niche Assets", next: "inv_niche_check" }, // NEW
                { label: "Raw Land", next: "inv_land_check" }
            ]
        },
        inv_niche_check: { // NEW
            text: "Which Niche Asset?",
            options: [
                { label: "Wholesaling", next: "strat_wholesaling" },
                { label: "Mobile Home Parks", next: "strat_mhp_invest" },
                { label: "Storage Units", next: "strat_storage_invest" },
                { label: "Laundromat / Car Wash", next: "strat_operational_asset" } // NEW
            ]
        },
        inv_airbnb_check: {
            text: "Management style?",
            options: [ { label: "Self-Manage", next: "inv_airbnb_pricing" }, { label: "Property Manager", next: "strat_str_managed" } ]
        },
        inv_airbnb_pricing: {
            text: "Have you analyzed dynamic pricing?",
            options: [ { label: "Yes", next: "strat_str_self" }, { label: "No", next: "strat_airbnb_dynamic_pricing" } ]
        },
        inv_land_check: {
            text: "Improved or Raw?",
            options: [ { label: "Improved", next: "strat_land_build" }, { label: "Raw", next: "inv_land_survey" } ]
        },
        inv_land_survey: {
            text: "Perc Test done?",
            options: [ { label: "Yes", next: "strat_land_hold" }, { label: "No", next: "strat_land_feasibility" } ]
        },
        inv_unit_count: {
            text: "Size?",
            options: [ { label: "2-4 Units", next: "strat_buy_hold" }, { label: "5+ Units", next: "strat_multifamily_commercial" } ]
        },
        inv_passive_check: {
            text: "Accredited?",
            options: [ { label: "Yes", next: "inv_syndication_type" }, { label: "No", next: "strat_reit" } ]
        },
        inv_syndication_type: {
            text: "Strategy Preference?",
            options: [ { label: "Value Add", next: "strat_syndication" }, { label: "Cost Segregation Focus", next: "strat_cost_seg" } ]
        },
        inv_1031_window: {
            text: "Sold <45 days ago?",
            options: [ { label: "Yes", next: "inv_1031_boot" }, { label: "No", next: "strat_1031" } ]
        },
        inv_1031_boot: {
            text: "Are you taking any cash out (Boot)?",
            options: [ { label: "Yes", next: "strat_1031_boot_tax" }, { label: "No, full reinvestment", next: "strat_dst" } ]
        },

        // ==========================================
        // BRANCH 5: COMMERCIAL
        // ==========================================
        comm_node_1: {
            text: "Property Type?",
            options: [
                { label: "Retail/Restaurant", next: "comm_retail_node" },
                { label: "Office/Medical", next: "comm_office_node" },
                { label: "Industrial", next: "comm_industrial_node" },
                { label: "Mixed-Use (Apts+Retail)", next: "strat_mixed_use" }, // NEW
                { label: "Gas Station/Auto", next: "comm_env_check" }
            ]
        },
        comm_env_check: {
            text: "Phase 1 Report?",
            options: [
                { label: "Clean", next: "strat_sba_504" },
                { label: "Dirty/Unknown", next: "strat_phase_2_env" }
            ]
        },
        comm_retail_node: {
            text: "Use?",
            options: [ { label: "Restaurant", next: "strat_restaurant_buy" }, { label: "Liquor Store", next: "strat_liquor_license" }, { label: "General", next: "comm_retail_signage" } ]
        },
        comm_retail_signage: {
            text: "Is visibility critical?",
            options: [ { label: "Yes, need Pylon Sign", next: "strat_pylon_signage" }, { label: "No", next: "comm_lease_own" } ]
        },
        comm_office_node: {
            text: "Use?",
            options: [ { label: "Medical", next: "comm_parking_check" }, { label: "General", next: "comm_lease_own" } ]
        },
        comm_parking_check: {
            text: "Does it meet 5:1000 Parking Ratio?",
            options: [ { label: "Yes", next: "strat_medical_office" }, { label: "No", next: "strat_parking_variance" } ]
        },
        comm_industrial_node: {
            text: "Requirement?",
            options: [ { label: "High Ceilings", next: "comm_crane_check" }, { label: "Loading Docks", next: "comm_loading_check" } ]
        },
        comm_loading_check: {
            text: "Dock Height or Drive-In?",
            options: [ { label: "Dock Height", next: "strat_industrial_logistics" }, { label: "Drive-In", next: "strat_flex_space" } ]
        },
        comm_crane_check: {
            text: "Need Overhead Cranes?",
            options: [ { label: "Yes", next: "strat_heavy_manufacturing" }, { label: "No", next: "strat_flex_space" } ]
        },
        comm_lease_own: {
            text: "Strategy?",
            options: [ { label: "Buy", next: "strat_sba_504" }, { label: "Lease", next: "comm_lease_guarantee" }, { label: "Biz Only", next: "strat_biz_opp" } ]
        },
        comm_lease_guarantee: {
            text: "Will you sign a Personal Guarantee?",
            options: [ { label: "Yes", next: "strat_burn_off_clause" }, { label: "No", next: "strat_lease_audit" } ]
        },

        // ==========================================
        // BRANCH 6: LAND / DEVELOPMENT (NEW)
        // ==========================================
        land_node_1: {
            text: "What is the current zoning?",
            options: [
                { label: "Residential", next: "land_infill_check" },
                { label: "Agricultural", next: "strat_ag_zoning" },
                { label: "Commercial", next: "strat_land_hold" }
            ]
        },
        land_infill_check: {
            text: "Is this an infill lot (between existing homes)?",
            options: [
                { label: "Yes", next: "strat_infill_development" },
                { label: "No, large tract", next: "strat_subdivision" }
            ]
        },

        // ==========================================
        // OUTCOMES
        // ==========================================
        
        // --- NEW OUTCOMES (Total now >150) ---
        strat_construction_loan: { text: "Strategy: Construction-to-Perm Loan. For custom homes, we secure one loan that covers the land purchase and the build. You pay interest-only during construction, then it converts to a mortgage.", options: [] },
        strat_pool_inspection: { text: "Strategy: Pool Inspection. Standard inspectors skip pools. We need a specific pool specialist to pressure test the lines for leaks and check the heater/pump functionality.", options: [] },
        strat_stigma_disclosure: { text: "Strategy: Stigma Management. Illinois law does not mandate disclosing deaths, but it's best practice to be transparent to avoid lawsuits. We will disclose upfront to filter for comfortable buyers.", options: [] },
        strat_operational_asset: { text: "Strategy: Operational Asset Valuation. Laundromats and Car Washes are valued by a multiple of EBITDA, not just real estate comps. We need 3 years of tax returns to verify the cash flow.", options: [] },
        strat_mixed_use: { text: "Strategy: Mixed-Use Financing. Lenders get tricky here. If the residential component is >51% of the square footage, we might get residential rates. If commercial dominates, we need a commercial loan.", options: [] },
        strat_ag_zoning: { text: "Strategy: Ag Zoning Due Diligence. Buying farm land to build requires rezoning. We must check the county's 'Comprehensive Plan' to see if they allow density increases in that sector.", options: [] },
        strat_infill_development: { text: "Strategy: Infill Development. The value is in the 'Buildability'. We need a survey to confirm setbacks and Floor Area Ratio (FAR) allow for a home size that justifies the land price.", options: [] },
        strat_subdivision: { text: "Strategy: Subdivision Entitlement. The profit is in the paper. We buy the land contingent on the village approving a 'Preliminary Plat of Subdivision', allowing us to split 1 lot into 10.", options: [] },
        strat_employment_gap_letter: { text: "Strategy: Offer Letter Verification. If you have a gap, lenders will accept a signed Offer Letter from your new job stating your start date and salary, allowing you to close before your first paycheck.", options: [] },
        strat_va_fee_waiver: { text: "Strategy: VA Funding Fee Waiver. Because you have a service-connected disability rating of 10% or higher, you are exempt from the VA Funding Fee, saving you thousands at closing.", options: [] },
        strat_va_bonus_entitlement: { text: "Strategy: VA Bonus Entitlement. You can have two VA loans at once. We calculate your remaining entitlement to see if you can buy this home with $0 down despite owning another.", options: [] },
        strat_subject_to: { text: "Strategy: Subject-To Acquisition. You take over the seller's existing mortgage payments without formally assuming the loan. The deed transfers to you, but the low interest rate stays.", options: [] },
        strat_seller_finance: { text: "Strategy: Seller Financing. The seller acts as the bank. We negotiate a Promissory Note with terms (interest rate, term, down payment) that work for both parties. No bank underwriting needed.", options: [] },
        strat_lease_option: { text: "Strategy: Lease Option. You rent the property with the 'Option' to buy it at a set price later. Part of your rent can go toward the down payment.", options: [] },
        strat_airbnb_dynamic_pricing: { text: "Strategy: Dynamic Pricing. We integrate software like PriceLabs. It adjusts your nightly rate based on local demand/events, increasing revenue by ~20% vs static pricing.", options: [] },
        strat_cost_seg: { text: "Strategy: Cost Segregation Study. We accelerate depreciation on the building's components (flooring, lighting) to 5 or 15 years, creating massive tax write-offs in Year 1.", options: [] },
        strat_1031_boot_tax: { text: "Strategy: Partial Exchange (Boot). Taking cash out is taxable 'Boot'. We must set aside capital gains tax on that specific amount while the rest defers tax-free.", options: [] },
        strat_pylon_signage: { text: "Strategy: Signage Rights Negotiation. For retail, visibility is key. We negotiate specific spots on the Pylon Sign and building facade into the Lease/Purchase contract.", options: [] },
        strat_burn_off_clause: { text: "Strategy: Good Guy / Burn-Off Clause. We negotiate that your Personal Guarantee 'burns off' after 2-3 years of on-time payments, limiting your long-term liability.", options: [] },
        strat_cash_keys_coop: { text: "Strategy: Cash for Cooperation. Instead of eviction, we offer tenants a financial incentive to keep the place clean for showings and vacate smoothly at closing.", options: [] },
        strat_probate_intestate: { text: "Strategy: Intestate Succession. Without a will, state law determines heirs. We need a 'Table of Heirship' and potentially a surety bond to clear title.", options: [] },
        strat_quit_claim: { text: "Strategy: Quit Claim Deed. You transfer your interest to your spouse. We must ensure you are also removed from the mortgage (Refinance or Assumption) to protect your DTI.", options: [] },
        strat_info_only_inspection: { text: "Strategy: Info-Only Inspection. You reserve the right to inspect, but agree not to ask for repairs. You can still walk away if major issues are found. Makes your offer stronger.", options: [] },
        strat_appraisal_gap_guarantee: { text: "Strategy: Appraisal Gap Guarantee. You agree to pay the difference in cash if the home appraises for less than purchase price. This wins bidding wars.", options: [] },
        strat_escalation_clause: { text: "Strategy: Escalation Clause. You bid $X, but agree to beat any higher bonafide offer by $1,000 up to a cap of $Y. Keeps you from overpaying.", options: [] },
        strat_lead_paint: { text: "Strategy: Lead-Based Paint Contingency. For pre-1978 homes, you get a 10-day window to test for lead. Essential if you have young children.", options: [] },
        strat_sewer_scope: { text: "Strategy: Sewer Scope Inspection. We send a camera down the main line to the street. Collapsed clay pipes cost $10k+ to fix. Always check this on older homes.", options: [] },
        strat_septic_inspection: { text: "Strategy: Septic Load Test. We test the tank and leech field. If it fails hydraulic load, the seller must replace it (often $20k-$40k cost) before closing.", options: [] },
        strat_pet_showing_plan: { text: "Strategy: Pet Logistics Plan. We set specific showing blocks so you can remove pets. We also use air purifiers to neutralize odors before listing.", options: [] },
        strat_green_mortgage: { text: "Strategy: Energy Efficient Mortgage (EEM). We finance energy upgrades (windows, insulation) into the loan. The appraiser credits the energy savings to your income.", options: [] },
        strat_itin_loan: { text: "Strategy: ITIN Financing. For foreign nationals with an ITIN. 15-20% down, higher rates, but qualifies on ITIN tax returns.", options: [] },
        strat_foreign_national: { text: "Strategy: Foreign National Loan. DSCR loan for non-residents. 25-30% down, qualifies on rental income.", options: [] },
        strat_co_buy_agreement: { text: "Strategy: Co-Buying Agreement. Title as 'Tenants in Common'. Legal agreement required for exit strategy.", options: [] },
        strat_corp_relo: { text: "Strategy: Corporate Relocation Rider. Counselor must review contract to protect your benefits.", options: [] },
        strat_tiny_home: { text: "Strategy: Tiny Home / ADU Zoning. Verify zoning for ADUs or unincorporated land.", options: [] },
        strat_hoarder_cleanout: { text: "Strategy: Discrete Cleanout Sale. No photos yet. Compassionate cleanout crew first.", options: [] },
        strat_vacant_staging: { text: "Strategy: Virtual Staging. Use digital furniture to help buyers visualize layout.", options: [] },
        strat_utility_activation: { text: "Strategy: Utility De-Winterization. Activate systems 3 days prior to inspection.", options: [] },
        strat_structural_eng: { text: "Strategy: Structural Engineer Report. Pre-inspect to silence buyer fears about cracks.", options: [] },
        strat_home_warranty: { text: "Strategy: Seller Coverage Warranty. Covers HVAC/Appliances during listing.", options: [] },
        strat_solar_lease_transfer: { text: "Strategy: Solar Lease Transfer. Buyer must qualify for lease. Initiate transfer early.", options: [] },
        strat_historic_sale: { text: "Strategy: Historic Tax Freeze. Market the Property Tax Assessment Freeze potential.", options: [] },
        strat_divorce_refi: { text: "Strategy: Owelty Lien. Buyout spouse equity via Rate/Term refi rates.", options: [] },
        strat_reverse_purchase: { text: "Strategy: HECM for Purchase. 50% down, no payments for life (62+).", options: [] },
        strat_sdir_custodian: { text: "Strategy: Self-Directed IRA. Use a Custodian. Contract in IRA name.", options: [] },
        strat_wholesaling: { text: "Strategy: Wholesaling. Assign contract for a fee. Check local license laws.", options: [] },
        strat_mhp_invest: { text: "Strategy: Mobile Home Park. Own the dirt, rent the pads. Check utilities.", options: [] },
        strat_student_housing: { text: "Strategy: Student Housing. Rent by bedroom. Parental guarantees required.", options: [] },
        strat_storage_invest: { text: "Strategy: Self-Storage. Climate controlled, automated kiosks.", options: [] },
        strat_phase_2_env: { text: "Strategy: Phase 2 Environmental. Drill soil samples. Negotiate on contamination.", options: [] },
        strat_liquor_license: { text: "Strategy: Liquor License Transfer. Verify municipal transferability.", options: [] },
        strat_parking_variance: { text: "Strategy: Parking Variance. Petition zoning for reduced parking requirements.", options: [] },
        strat_heavy_manufacturing: { text: "Strategy: Heavy Manufacturing. Verify floor load and bridge crane capacity.", options: [] },
        strat_ot_avg: { text: "Strategy: Overtime Averaging. 2-year average required. Employer letter helps.", options: [] },
        strat_medical_collections: { text: "Strategy: Medical Debt Exclusion. FHA/Conventional often ignore medical debt.", options: [] },
        strat_green_marketing: { text: "Strategy: Green Premium. Green Addendum appraisal for owned solar.", options: [] },
        strat_virtual_tour: { text: "Strategy: Virtual Relocation. Live video tours + Sight Unseen rider.", options: [] },
        strat_jumbo_loan: { text: "Strategy: Jumbo Financing. Portfolio lenders for >$766k.", options: [] },
        strat_usda_loan: { text: "Strategy: USDA Rural Development. 0% down in eligible areas.", options: [] },
        strat_fsbo_conversion: { text: "Strategy: MLS Exposure Plan. Unlock 97% of buyers.", options: [] },
        strat_expired_relist: { text: "Strategy: Fresh Market Refresh. New photos, price, and description.", options: [] },
        strat_cap_gains_calc: { text: "Strategy: Tax Deferred Analysis. 1031 Exchange vs Capital Gains.", options: [] },
        strat_private_showings: { text: "Strategy: Appointment-Only. Strict vetting of buyers.", options: [] },
        strat_str_self: { text: "Strategy: Self-Managed Airbnb. Automate cleaning/messaging.", options: [] },
        strat_str_managed: { text: "Strategy: Managed STR. Pay 20% for passive income.", options: [] },
        strat_land_build: { text: "Strategy: Construction-to-Perm Loan. One closing for lot+build.", options: [] },
        strat_zoning_attorney: { text: "Strategy: Zoning Contingency. Contingent on Special Use Permit.", options: [] },
        strat_biz_opp: { text: "Strategy: Business Asset Sale. Buy cash flow, not real estate.", options: [] },
        strat_bank_statement: { text: "Strategy: Bank Statement Loan. 12mo deposits for income.", options: [] },
        strat_physician_loan: { text: "Strategy: Physician Loan. Exclude student debt DTI.", options: [] },
        strat_manual_underwriting: { text: "Strategy: Manual Underwriting. Manual review of credit.", options: [] },
        strat_hard_money_buy: { text: "Strategy: Hard Money Bridge. Secure now, refi later.", options: [] },
        strat_new_construction: { text: "Strategy: Builder Representation. Negotiate upgrades.", options: [] },
        strat_builder_reg: { text: "Strategy: Builder Intervention. Review contract, protect deposit.", options: [] },
        strat_divorce_neutral: { text: "Strategy: Neutral Third-Party Sale. Unbiased representation.", options: [] },
        strat_senior_transition: { text: "Strategy: Rightsizing. Estate sales and 55+ move.", options: [] },
        strat_luxury_private: { text: "Strategy: Private Placement. Off-market sale.", options: [] },
        strat_eviction_sale: { text: "Strategy: Cash-for-Keys. Pay tenant to leave.", options: [] },
        strat_probate_conflict: { text: "Strategy: Mediator Sale. Transparent offer presentation.", options: [] },
        strat_house_hack_invest: { text: "Strategy: House Hack. FHA 3.5% on 2-4 units.", options: [] },
        strat_multifamily_commercial: { text: "Strategy: DSCR Loan. Income based loan.", options: [] },
        strat_restaurant_buy: { text: "Strategy: 2nd Gen Restaurant. Save buildout costs.", options: [] },
        strat_medical_office: { text: "Strategy: TI Negotiation. Landlord pays buildout.", options: [] },
        strat_flex_space: { text: "Strategy: Flex Space. Rear load + front office.", options: [] },
        strat_commuter_hub: { text: "Strategy: Transit-Oriented. Walk to Train.", options: [] },
        strat_school_zone: { text: "Strategy: District Search. School boundaries.", options: [] },
        strat_va_loan: { text: "Strategy: VA Loan. 0% down, no PMI.", options: [] },
        strat_203k_rehab: { text: "Strategy: FHA 203k. Purchase + Rehab loan.", options: [] },
        res_grant: { text: "Strategy: Down Payment Assistance. IHDA grants.", options: [] },
        res_fha_standard: { text: "Strategy: FHA 3.5%. Low down payment.", options: [] },
        res_credit_repair: { text: "Strategy: Credit Roadmap. Fix DTI/Score.", options: [] },
        strat_concurrent: { text: "Strategy: Concurrent Closing. Sell AM, Buy PM.", options: [] },
        strat_bridge: { text: "Strategy: Bridge Loan. Buy before selling.", options: [] },
        strat_sell_first: { text: "Strategy: Home of Choice Contingency.", options: [] },
        strat_vacation: { text: "Strategy: STR Analysis. Verify ROI.", options: [] },
        strat_leaseback: { text: "Strategy: Rent-Back. Stay after closing.", options: [] },
        strat_luxury_listing: { text: "Strategy: Lifestyle Marketing. Global syndication.", options: [] },
        strat_tenant_sale: { text: "Strategy: Cap Rate Sale. Investor to Investor.", options: [] },
        strat_concierge: { text: "Strategy: Concierge Listing. Staging/Prep.", options: [] },
        strat_instant: { text: "Strategy: Instant Offer. Speed over price.", options: [] },
        strat_hold_rent: { text: "Strategy: Rent & Hold. Wait for equity.", options: [] },
        strat_short_sale: { text: "Strategy: Short Sale. Debt forgiveness.", options: [] },
        strat_deed_lieu: { text: "Strategy: Deed in Lieu. Avoid foreclosure.", options: [] },
        strat_probate_easy: { text: "Strategy: Independent Admin. Fast probate.", options: [] },
        strat_probate_court: { text: "Strategy: Court Approval. Judge sign-off.", options: [] },
        strat_probate_bond: { text: "Strategy: Bond in Lieu. Sell early.", options: [] },
        strat_turnkey: { text: "Strategy: Turnkey. Renovated/Tenanted.", options: [] },
        strat_dst: { text: "Strategy: DST 1031. Passive replacement.", options: [] },
        strat_fix_flip: { text: "Strategy: 70% Rule. Buy deep.", options: [] },
        strat_brrrr: { text: "Strategy: BRRRR. Refinance capital out.", options: [] },
        strat_buy_hold: { text: "Strategy: Cash Flow. Long term wealth.", options: [] },
        strat_syndication: { text: "Strategy: Syndication LP. Passive commercial.", options: [] },
        strat_reit: { text: "Strategy: REIT. Liquid stock.", options: [] },
        strat_hold_refi: { text: "Strategy: Cash-Out Refi. Buy assets.", options: [] },
        strat_1031: { text: "Strategy: 1031 Exchange. Defer taxes.", options: [] },
        strat_sba_504: { text: "Strategy: SBA 504. 10% down business.", options: [] },
        strat_lease_audit: { text: "Strategy: NNN Audit. Check CAM.", options: [] },
        strat_lease_base_year: { text: "Strategy: Base Year Stop. Cap expenses.", options: [] },
        strat_industrial_logistics: { text: "Strategy: Logistics Focus. 14ft doors.", options: [] },
        res_conventional_check: { text: "Strategy: Conventional Loan. 3-5% down.", options: [] },
        strat_streamline_refi: { text: "Strategy: FHA/VA Streamline. Low doc refi.", options: [] },
        strat_rate_term_refi: { text: "Strategy: Rate & Term Refi. Lower payment.", options: [] },
        strat_debt_consolidation: { text: "Strategy: Debt Consolidation. Pay off cards.", options: [] },
        strat_renovation_heloc: { text: "Strategy: HELOC. Renovation funds.", options: [] },
        strat_cash_out_invest: { text: "Strategy: Cash Out Invest. Buy rental.", options: [] },
        strat_pmi_removal: { text: "Strategy: PMI Removal. Appraise value.", options: [] },
        strat_appraisal_gap: { text: "Strategy: Appraisal Gap Analysis.", options: [] },
        strat_fha_ibr: { text: "Strategy: FHA IBR. Student loans.", options: [] },
        strat_conventional_1percent: { text: "Strategy: Conventional Student Loan.", options: [] },
        strat_cosigner_fha: { text: "Strategy: Co-Borrower. Blend income.", options: [] },
        strat_condo_warrantable: { text: "Strategy: Warrantable Condo.", options: [] },
        strat_non_warrantable: { text: "Strategy: Non-Warrantable.", options: [] },
        strat_solar_check: { text: "Strategy: Solar Lease Check.", options: [] },
        strat_multigen_search: { text: "Strategy: Multi-Gen.", options: [] },
        strat_rsu_income: { text: "Strategy: RSU Income.", options: [] },
        strat_asset_depletion: { text: "Strategy: Asset Depletion.", options: [] },
        strat_remove_disputes: { text: "Strategy: Dispute Removal.", options: [] },
        strat_gift_letter: { text: "Strategy: Gift Letter.", options: [] },
        strat_trust_sale: { text: "Strategy: Trust Sale.", options: [] },
        strat_retro_permit: { text: "Strategy: Retroactive Permit.", options: [] },
        strat_title_clearance: { text: "Strategy: Title Clearance.", options: [] },
        strat_reverse_mortgage_sale: { text: "Strategy: HECM Payoff.", options: [] },
        strat_phase_1_env: { text: "Strategy: Phase 1 Enviro.", options: [] },
        strat_heavy_industrial: { text: "Strategy: Heavy Power.", options: [] },
        strat_land_feasibility: { text: "Strategy: Land Feasibility.", options: [] },
        strat_cash_out_refi: { text: "Strategy: Cash-Out Refinance. Replace entire mortgage to access equity.", options: [] },
        strat_renovation_heloc: { text: "Strategy: HELOC. Keep low primary rate, use line of credit for repairs.", options: [] },
        strat_land_hold: { text: "Strategy: Land Banking. Speculative hold for future development.", options: [] }
    };

    let currentNode = 'start';
    let history = []; 
    let pathLabels = []; 

    const elements = {
        question: document.getElementById('question-text'),
        options: document.getElementById('options-container'),
        backBtn: document.getElementById('back-btn'),
        progress: document.getElementById('progress-bar-fill'),
        step: document.getElementById('step-counter'),
        formContainer: document.getElementById('contact-form-container'),
        message: document.getElementById('message-field')
    };

    function renderNode() {
        const node = tree[currentNode];
        if(!node) {
            console.error("Node not found:", currentNode);
            return;
        }

        elements.question.innerText = node.text;
        elements.options.innerHTML = '';
        
        const isResult = node.options.length === 0;
        const stepCount = history.length + 1;
        
        elements.step.innerText = isResult ? 'Strategy Found' : `Step ${stepCount}`;
        elements.progress.style.width = isResult ? '100%' : Math.min(stepCount * 4, 95) + '%';
        elements.backBtn.style.display = (history.length > 0) ? 'block' : 'none';

        if (isResult) {
            elements.question.classList.add('result-card');
            elements.formContainer.style.display = 'block';
            
            let complianceNote = "\n\n*Local Compliance Note (Villa Park/IL):* \n- Transfer Stamps: $0 (Villa Park), but Inspection Required ($50).\n- Mandatory Disclosures: IL Radon, Lead-Based Paint (Pre-1978).";
            elements.message.value = "Client Path: " + pathLabels.join(" > ") + "\n\nGenerated Strategy: " + node.text + complianceNote;
            
            const restartBtn = document.createElement('button');
            restartBtn.innerText = "Start Over / Try Another Scenario";
            restartBtn.className = "tree-option-btn";
            restartBtn.style.textAlign = "center";
            restartBtn.style.marginTop = "20px";
            restartBtn.style.background = "#fff";
            restartBtn.onclick = () => { 
                history = []; 
                pathLabels = []; 
                currentNode = 'start'; 
                renderNode(); 
            };
            elements.options.appendChild(restartBtn);
        } else {
            elements.question.classList.remove('result-card');
            elements.formContainer.style.display = 'none';
            node.options.forEach(opt => {
                const btn = document.createElement('button');
                btn.innerText = opt.label;
                btn.className = "tree-option-btn";
                btn.onclick = () => {
                    history.push(currentNode);
                    pathLabels.push(opt.label);
                    currentNode = opt.next;
                    renderNode();
                };
                elements.options.appendChild(btn);
            });
        }
    }

    elements.backBtn.onclick = () => {
        if (history.length > 0) {
            currentNode = history.pop();
            pathLabels.pop();
            renderNode();
        }
    };

    renderNode();
});
</script>
</body>
</html>
