<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Pavlo Rospopa Real Estate Strategy Engine</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/format.css">
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>

    <style>
        body { -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f7f9; }
        input, textarea { -webkit-user-select: text; -moz-user-select: text; -ms-user-select: text; user-select: text; }

        #real-estate-guide-container {
            margin: 40px auto; padding: 30px; border: 1px solid #e0e0e0; border-radius: 12px;
            background-color: #ffffff; box-shadow: 0 4px 15px rgba(0,0,0,0.05); position: relative; z-index: 101;
            max-width: 900px;
        }
        .tree-option-btn {
            padding: 14px 18px; background-color: #f8f9fa; color: #333; border: 2px solid #eef0f2;
            border-radius: 8px; cursor: pointer; font-size: 1rem; text-align: left;
            transition: all 0.2s; font-weight: 500; width: 100%; margin-bottom: 8px; display: block;
        }
        .tree-option-btn:hover { border-color: #4285F4; color: #4285F4; transform: translateX(4px); }
        .result-card { background: #f4f7ff; border-left: 6px solid #4285F4; padding: 25px; border-radius: 8px; color: #334155; line-height: 1.7; margin-bottom: 20px; }

        #contact-form-container { margin: 40px 0; padding: 20px; border: 1px solid #e0e0e0; border-radius: 8px; background-color: #f9f9f9; }
        #contact-form { display: flex; flex-direction: column; gap: 15px; }
        #contact-form input, #contact-form textarea { padding: 12px; border: 1px solid #ccc; border-radius: 4px; width: 100%; box-sizing: border-box; }
        #contact-form button { padding: 12px 24px; background-color: #333; color: white; border: none; border-radius: 4px; cursor: pointer; align-self: flex-start; font-weight: bold; }
        #contact-form button:hover { background-color: #555; }
        
        .progress-container { width: 100%; height: 8px; background: #eee; border-radius: 4px; margin: 15px 0; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #4285F4, #34a853); transition: width 0.3s ease; }
    </style>
</head>
     
<body>

<header class="site-header">
    <div class="wrap" style="text-align: center; padding: 20px 0;">
        <a class="site-title" style="text-decoration: none; font-size: 2rem; color: #333; font-weight: 800;" href="https://rospopa.com">Pavlo Rospopa Strategy Engine</a>
    </div>
</header>

<main>
    <div class="page-content">
        <div class="wrap">
            <div id="real-estate-guide-container">
                
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <button id="back-btn" style="background:none; border:none; color:#4285F4; cursor:pointer; font-weight:bold; display:none;">‚Üê Back</button>
                    <span id="step-counter" style="color:#888; font-size:0.9rem;">Start</span>
                </div>
                
                <div class="progress-container">
                    <div id="progress-bar-fill" class="progress-fill" style="width: 2%;"></div>
                </div>

                <div id="tree-content">
                    <h2 id="question-text" style="margin-bottom: 25px; font-size: 1.4rem; color: #222; font-weight: 700;">Loading Logic...</h2>
                    <div id="options-container"></div>
                </div>

                <div id="contact-form-container" style="display: none;">
                    <h3 style="margin-top:0;">Request This Strategy</h3>
                    <p style="font-size: 0.9rem; color: #666; margin-bottom: 15px;">Based on your answers, this is the most efficient path forward.</p>
                    <form id="contact-form">
                        <input type="text" name="name" placeholder="Your Name" required />
                        <input type="email" name="email" placeholder="Your Email" required />
                        <input type="tel" name="phone" placeholder="Phone Number (Optional)" />
                        <textarea id="message-field" name="message" rows="5" required></textarea>
                        <div class="g-recaptcha" data-sitekey="6Let_E8sAAAAAP948s5QuqjQ-HKYRuoXxLzILZ9p"></div>
                        <button type="submit" id="submit-btn">Send Request</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</main>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const tree = {
        // --- ROOT ---
        start: {
            text: "What is your primary Real Estate Goal?",
            options: [
                { label: "Residential: Buying a Home", next: "buy_node_1" },
                { label: "Residential: Selling a Home", next: "sell_node_1" },
                { label: "Wealth: Investment Properties", next: "invest_node_1" },
                { label: "Commercial / Business Needs", next: "comm_node_1" }
            ]
        },

        // ==========================================
        // BRANCH 1: BUYING (Deep Dive)
        // ==========================================
        buy_node_1: {
            text: "Have you owned a home in the last 3 years?",
            options: [
                { label: "No (First-Time Buyer)", next: "buy_fthb_triage" },
                { label: "Yes (Repeat Buyer)", next: "buy_repeat_triage" }
            ]
        },
        // --- FTHB PATH ---
        buy_fthb_triage: {
            text: "What is your biggest hurdle right now?",
            options: [
                { label: "Down Payment / Cash", next: "buy_down_source" },
                { label: "Credit Score", next: "buy_credit_deep" },
                { label: "Income / Employment Type", next: "buy_income_check" },
                { label: "Finding the Right House", next: "buy_inventory_triage" }
            ]
        },
        // Income Logic
        buy_income_check: {
            text: "How is your income primarily derived?",
            options: [
                { label: "W-2 Employee (Salary/Hourly)", next: "buy_time_job" },
                { label: "Self-Employed / 1099", next: "buy_self_emp_years" },
                { label: "Medical Resident / Doctor", next: "strat_physician_loan" }
            ]
        },
        buy_time_job: {
            text: "Have you been in the same line of work for 2 years?",
            options: [
                { label: "Yes", next: "res_fha_standard" },
                { label: "No, large gaps in employment", next: "strat_manual_underwriting" }
            ]
        },
        buy_self_emp_years: {
            text: "Do your tax returns show strong net income for the last 2 years?",
            options: [
                { label: "Yes, I show profit", next: "res_fha_standard" },
                { label: "No, I write everything off", next: "strat_bank_statement" }
            ]
        },
        // Credit Deep Dive
        buy_credit_deep: {
            text: "Do you know your approximate credit score?",
            options: [
                { label: "Excellent (720+)", next: "res_conventional_check" },
                { label: "Good (620 - 719)", next: "res_fha_standard" },
                { label: "Fair (580 - 619)", next: "buy_credit_issues" },
                { label: "Poor (<580)", next: "res_credit_repair" }
            ]
        },
        buy_credit_issues: {
            text: "Are there recent bankruptcies or foreclosures?",
            options: [
                { label: "Yes, within 2 years", next: "strat_hard_money_buy" },
                { label: "No, just high utilization", next: "res_credit_repair" }
            ]
        },
        // Down Payment Logic
        buy_down_source: {
            text: "Are you (or your spouse) a Military Veteran?",
            options: [
                { label: "Yes", next: "strat_va_loan" },
                { label: "No", next: "buy_gift_check" }
            ]
        },
        buy_gift_check: {
            text: "Do you have access to gift funds from family?",
            options: [
                { label: "Yes, family can help", next: "res_fha_standard" },
                { label: "No, I need a grant", next: "res_grant" }
            ]
        },
        // Inventory Logic
        buy_inventory_triage: {
            text: "What type of home are you looking for?",
            options: [
                { label: "Move-In Ready Resale", next: "buy_condo_check" },
                { label: "Fixer Upper", next: "buy_renovation_cash" },
                { label: "Brand New Construction", next: "buy_new_build_check" }
            ]
        },
        buy_new_build_check: {
            text: "Have you already visited the sales center?",
            options: [
                { label: "Yes, I registered", next: "strat_builder_reg" },
                { label: "No, not yet", next: "strat_new_construction" }
            ]
        },
        buy_renovation_cash: {
            text: "Do you have extra cash for the repairs?",
            options: [
                { label: "Yes, I have savings", next: "res_fha_standard" },
                { label: "No, I need to finance repairs", next: "strat_203k_rehab" }
            ]
        },
        buy_condo_check: {
            text: "Would you consider a Condo or Townhome?",
            options: [
                { label: "Yes", next: "strat_condo_warrantable" },
                { label: "No, Single Family Only", next: "buy_commute_check" }
            ]
        },
        buy_commute_check: {
            text: "Is school district or commute your #1 priority?",
            options: [
                { label: "Schools", next: "strat_school_zone" },
                { label: "Commute / Train", next: "strat_commuter_hub" }
            ]
        },

        // --- REPEAT BUYER PATH ---
        buy_repeat_triage: {
            text: "Do you need to sell your current home to buy the new one?",
            options: [
                { label: "Yes, I need the equity", next: "buy_contingency" },
                { label: "No, I can keep both", next: "buy_2nd_home" }
            ]
        },
        buy_contingency: {
            text: "Is your current home currently on the market?",
            options: [
                { label: "Yes, it's listed", next: "strat_concurrent" },
                { label: "Not yet", next: "buy_equity_check" }
            ]
        },
        buy_equity_check: {
            text: "Do you have significant equity (>30%) in the current home?",
            options: [
                { label: "Yes, lots of equity", next: "strat_bridge" },
                { label: "No / Not sure", next: "strat_sell_first" }
            ]
        },
        buy_2nd_home: {
            text: "What is the primary use of this new property?",
            options: [
                { label: "Vacation / Short Term Rental", next: "strat_vacation" },
                { label: "Long Term Investment", next: "strat_buy_hold" }
            ]
        },

        // ==========================================
        // BRANCH 2: SELLING (Deep Dive)
        // ==========================================
        sell_node_1: {
            text: "What is the primary reason for selling?",
            options: [
                { label: "Upgrading / Downsizing", next: "sell_financial_status" },
                { label: "Financial Distress / Debt", next: "sell_distress" },
                { label: "Divorce / Separation", next: "sell_divorce_status" },
                { label: "Inheritance / Probate", next: "sell_probate" }
            ]
        },
        // Divorce Path
        sell_divorce_status: {
            text: "Is the separation amicable or contested?",
            options: [
                { label: "Amicable (We agree)", next: "sell_financial_status" },
                { label: "Contested (Lawyers involved)", next: "strat_divorce_neutral" }
            ]
        },
        // Financial Logic
        sell_financial_status: {
            text: "What is the equity status?",
            options: [
                { label: "Positive Equity (>20%)", next: "sell_retail_condition" },
                { label: "Low / Negative Equity", next: "sell_distress" }
            ]
        },
        sell_retail_condition: {
            text: "What is the condition of the property?",
            options: [
                { label: "Good / Needs Minor Updates", next: "sell_occupancy_check" },
                { label: "Needs Major Repairs", next: "sell_retail_fix" }
            ]
        },
        // Occupancy & Tenants
        sell_occupancy_check: {
            text: "Who is currently living in the property?",
            options: [
                { label: "I live there (Owner)", next: "sell_life_stage" },
                { label: "It's Vacant", next: "sell_luxury_check" },
                { label: "Tenants are there", next: "sell_tenant_lease" }
            ]
        },
        sell_life_stage: {
            text: "Are you downsizing for retirement?",
            options: [
                { label: "Yes, looking for 55+", next: "strat_senior_transition" },
                { label: "No, just moving", next: "sell_timeline_urgency" }
            ]
        },
        sell_tenant_lease: {
            text: "Are the tenants on a Month-to-Month lease or fixed term?",
            options: [
                { label: "Month-to-Month", next: "strat_concierge" },
                { label: "Fixed Term (Long)", next: "strat_tenant_sale" },
                { label: "They stopped paying", next: "strat_eviction_sale" }
            ]
        },
        sell_timeline_urgency: {
            text: "Do you have your next home lined up?",
            options: [
                { label: "Yes, I'm ready to move", next: "strat_concierge" },
                { label: "No, I need time", next: "strat_leaseback" }
            ]
        },
        sell_luxury_check: {
            text: "Is the estimated value over $800,000?",
            options: [
                { label: "Yes, Luxury Market", next: "sell_privacy_check" },
                { label: "No, Standard Market", next: "sell_retail_priority" }
            ]
        },
        sell_privacy_check: {
            text: "Do you require a private/off-market sale?",
            options: [
                { label: "Yes, no public photos", next: "strat_luxury_private" },
                { label: "No, full marketing", next: "strat_luxury_listing" }
            ]
        },
        sell_retail_fix: {
            text: "Do you have the cash/time to fix it before selling?",
            options: [
                { label: "Yes, fix for top dollar", next: "strat_concierge" },
                { label: "No, sell 'As-Is'", next: "strat_instant" }
            ]
        },
        sell_retail_priority: {
            text: "What is your main priority?",
            options: [
                { label: "Maximum Profit", next: "strat_concierge" },
                { label: "Maximum Speed", next: "strat_instant" },
                { label: "Convenience", next: "strat_guaranteed_offer" }
            ]
        },
        sell_distress: {
            text: "Are you behind on mortgage payments?",
            options: [
                { label: "Yes", next: "sell_hardship" },
                { label: "No, just low equity", next: "strat_hold_rent" }
            ]
        },
        sell_hardship: {
            text: "Do you have other significant assets (stocks, 2nd home)?",
            options: [
                { label: "Yes", next: "strat_short_sale" },
                { label: "No, this is it", next: "strat_deed_lieu" }
            ]
        },
        sell_probate: {
            text: "Do you have 'Letters of Office' from the court?",
            options: [
                { label: "Yes, fully authorized", next: "sell_probate_heirs" },
                { label: "No, still in process", next: "strat_probate_court" },
                { label: "I don't know", next: "strat_probate_bond" }
            ]
        },
        sell_probate_heirs: {
            text: "Do all heirs agree on selling?",
            options: [
                { label: "Yes, we agree", next: "strat_probate_easy" },
                { label: "No, there is conflict", next: "strat_probate_conflict" }
            ]
        },

        // ==========================================
        // BRANCH 3: INVESTMENT (Deep Dive)
        // ==========================================
        invest_node_1: {
            text: "What is your preferred involvement level?",
            options: [
                { label: "Active (Hands-on)", next: "inv_experience" },
                { label: "Passive (Hands-off)", next: "inv_passive_check" },
                { label: "Analyze Existing Asset", next: "inv_analyze" }
            ]
        },
        inv_experience: {
            text: "Have you managed a renovation or rental before?",
            options: [
                { label: "Yes, I'm experienced", next: "inv_active_risk" },
                { label: "No, I'm a beginner", next: "inv_beginner_path" }
            ]
        },
        inv_beginner_path: {
            text: "How much capital do you have to deploy?",
            options: [
                { label: "Under $50k", next: "strat_house_hack_invest" },
                { label: "$50k - $200k", next: "strat_turnkey" },
                { label: "$200k+", next: "strat_buy_hold" }
            ]
        },
        inv_active_risk: {
            text: "What is your risk tolerance?",
            options: [
                { label: "High (Aggressive Growth)", next: "strat_fix_flip" },
                { label: "Moderate (Value Add)", next: "strat_brrrr" },
                { label: "Low (Steady Cash Flow)", next: "inv_unit_count" }
            ]
        },
        inv_unit_count: {
            text: "What size property are you targeting?",
            options: [
                { label: "2-4 Units (Residential)", next: "strat_buy_hold" },
                { label: "5+ Units (Commercial)", next: "strat_multifamily_commercial" }
            ]
        },
        inv_passive_check: {
            text: "Are you an Accredited Investor ($200k+ income / $1M+ net worth)?",
            options: [
                { label: "Yes", next: "strat_syndication" },
                { label: "No", next: "strat_reit" }
            ]
        },
        inv_analyze: {
            text: "Does the asset's Return on Equity (ROE) exceed 7%?",
            options: [
                { label: "Yes, it performs well", next: "strat_hold_refi" },
                { label: "No, it's lazy equity", next: "inv_1031_window" }
            ]
        },
        inv_1031_window: {
            text: "Are you currently in a 1031 Exchange window (Sold <45 days ago)?",
            options: [
                { label: "Yes, clock is ticking", next: "strat_dst" }, 
                { label: "No, haven't sold yet", next: "strat_1031" }
            ]
        },

        // ==========================================
        // BRANCH 4: COMMERCIAL (Specifics)
        // ==========================================
        comm_node_1: {
            text: "What is the property type?",
            options: [
                { label: "Retail / Restaurant", next: "comm_retail_node" },
                { label: "Office / Medical", next: "comm_office_node" },
                { label: "Industrial / Flex", next: "comm_industrial_node" }
            ]
        },
        comm_retail_node: {
            text: "Is this a Restaurant or General Retail?",
            options: [
                { label: "Restaurant (Need Venting)", next: "strat_restaurant_buy" },
                { label: "General Retail", next: "comm_lease_own" }
            ]
        },
        comm_office_node: {
            text: "Is this for Medical use or General Office?",
            options: [
                { label: "Medical (Plumbing req)", next: "strat_medical_office" },
                { label: "General Office", next: "comm_lease_own" }
            ]
        },
        comm_industrial_node: {
            text: "What ceiling height do you need?",
            options: [
                { label: "Under 14ft", next: "strat_flex_space" },
                { label: "Over 18ft (Trucks)", next: "strat_industrial_logistics" }
            ]
        },
        comm_lease_own: {
            text: "Are you looking to Lease or Own?",
            options: [
                { label: "Buy (Owner-User)", next: "strat_sba_504" },
                { label: "Lease", next: "comm_lease_type" }
            ]
        },
        comm_lease_type: {
            text: "What lease structure is proposed?",
            options: [
                { label: "Triple Net (NNN)", next: "strat_lease_audit" },
                { label: "Modified Gross", next: "strat_lease_base_year" }
            ]
        },

        // ==========================================
        // OUTCOMES
        // ==========================================
        
        // --- NEW & SPECIALIZED ---
        strat_bank_statement: { text: "Strategy: Bank Statement Loan. Since you are self-employed with high write-offs, we will use a Non-QM lender who qualifies you based on 12-24 months of bank deposits rather than taxable income. Rates are slightly higher, but you get approved.", options: [] },
        strat_physician_loan: { text: "Strategy: Physician Loan. Lenders offer special products for Medical Residents/Doctors with student loans. They exclude student debt from DTI calculations and often allow 0-5% down with no PMI.", options: [] },
        strat_manual_underwriting: { text: "Strategy: Manual Underwriting. Due to employment gaps or lack of credit score, we must use a lender who manually reviews your file (rent history, utility payments) rather than relying on automated algorithms.", options: [] },
        strat_hard_money_buy: { text: "Strategy: Hard Money Purchase. Recent bankruptcy prevents standard loans. We will use a private money bridge loan to secure the property now, and refinance into a standard loan in 12-24 months once your seasoning period ends.", options: [] },
        strat_new_construction: { text: "Strategy: New Construction Representation. The sales rep works for the builder, not you. I will register as your agent to negotiate upgrades and lot premiums, and ensure a pre-drywall inspection is conducted.", options: [] },
        strat_builder_reg: { text: "Strategy: Builder Intervention. Since you already registered, I may not be able to officially represent you, but I can still review your contract and advise on inspection phases to protect your deposit.", options: [] },
        strat_divorce_neutral: { text: "Strategy: Neutral Third-Party Sale. In contested divorces, I act as a neutral party. I communicate with both attorneys separately, ensuring the home is sold for market value without emotional sabotage from either side.", options: [] },
        strat_senior_transition: { text: "Strategy: Senior Transition Service. We focus on 'Rightsizing'. I will coordinate with estate liquidators to handle the belongings you aren't keeping and target 55+ communities that offer maintenance-free living.", options: [] },
        strat_luxury_private: { text: "Strategy: Private Placement (Pocket Listing). For privacy, we will not list on the MLS. We will market directly to my network of high-net-worth individuals and buyer agents to secure a sale without public photos.", options: [] },
        strat_eviction_sale: { text: "Strategy: Cash-for-Keys or Eviction Sale. Selling a home with non-paying tenants is hard. We can either offer 'Cash for Keys' to get them out before listing, or sell to an investor who specializes in evictions.", options: [] },
        strat_probate_conflict: { text: "Strategy: Mediator Sale. When heirs disagree, the court may order a sale. We will focus on strict transparency, ensuring all offers are presented to all heirs simultaneously to prevent disputes.", options: [] },
        strat_house_hack_invest: { text: "Strategy: FHA House Hack. With low capital, you buy a 2-4 unit building with 3.5% down. You live in one unit and rent the others. This is the highest ROI strategy for beginners.", options: [] },
        strat_multifamily_commercial: { text: "Strategy: Commercial Multifamily Loan. For 5+ units, residential loans don't apply. We will look at DSCR loans where the building's income qualifies the loan, not your personal income.", options: [] },
        strat_restaurant_buy: { text: "Strategy: 2nd Gen Restaurant Acquisition. Building a kitchen from scratch is too expensive. We will target '2nd Generation' spaces that already have a black iron hood, grease trap, and walk-in cooler to save you $150k in buildout.", options: [] },
        strat_medical_office: { text: "Strategy: Medical Buildout. We need a shell with sufficient plumbing stacks for sinks in every exam room. We will negotiate a high 'TI' (Tenant Improvement) allowance from the landlord to cover these costs.", options: [] },
        strat_flex_space: { text: "Strategy: Flex/Office. You need a mix of warehouse and office. We will target business parks with rear drive-in doors but nice glass fronts for your customers.", options: [] },
        strat_guaranteed_offer: { text: "Strategy: Guaranteed Sale Program. If you need absolute certainty, I can present a cash offer floor. If the market doesn't beat it within X days, the cash offer stands.", options: [] },
        strat_commuter_hub: { text: "Strategy: Transit-Oriented Purchase. We will map your search specifically to Metra/Train lines (e.g., Union Pacific West), prioritizing homes within a 10-minute walk of the station to protect resale value.", options: [] },
        strat_school_zone: { text: "Strategy: District-First Search. We will filter properties strictly by school rating boundaries (e.g., District 88 or 45), as these boundaries drive property value retention more than the house itself.", options: [] },

        // --- CORE OUTCOMES ---
        strat_va_loan: { text: "Strategy: VA Loan (0% Down). Since you served, we will utilize the VA loan benefit. This offers 0% down payment and no mortgage insurance. We must ensure the property meets VA 'Minimum Property Requirements' (MPR).", options: [] },
        strat_203k_rehab: { text: "Strategy: FHA 203k Loan. Since you want to renovate but lack cash, we will wrap the renovation costs into the mortgage. You buy the house + the repairs in one loan with 3.5% down.", options: [] },
        strat_condo_warrantable: { text: "Strategy: Warrantable Condo. We must verify the condo association is 'Warrantable' (no litigation, >50% owner occupied) to ensure you can get standard financing rates.", options: [] },
        res_grant: { text: "Strategy: IHDA Grant Pairing. We will leverage Illinois Housing Development Authority programs to secure up to $10,000 in down payment assistance. Focus on lenders who can layer these grants without high rate bumps.", options: [] },
        res_fha_standard: { text: "Strategy: Standard FHA 3.5%. With a score over 620, you qualify for the 3.5% down payment with lower MIP costs. We can start shopping immediately.", options: [] },
        res_credit_repair: { text: "Strategy: Credit Repair Roadmap. You need a 6-month buffer. We will pause the search to focus on debt-to-income ratios. Targeting 620+ saves you thousands in MIP costs.", options: [] },
        strat_concurrent: { text: "Strategy: Concurrent Closing. Your sale is safe. We will line up the closings for the same day (Sale in AM, Buy in PM) so proceeds transfer directly at the title company.", options: [] },
        strat_bridge: { text: "Strategy: Bridge Loan / HELOC. Since you have high equity, we will tap into a HELOC or Bridge Loan on your current home to fund the down payment for the new one immediately.", options: [] },
        strat_sell_first: { text: "Strategy: Listing Preparation. To buy your next home, we must list your current one first. We will use a 'Home of Choice' contingency clause to protect you.", options: [] },
        strat_vacation: { text: "Strategy: Vacation Rental Analysis. We must verify local short-term rental laws (AirBnB rules). Income potential is high, but we need to calculate the specific tax implications.", options: [] },
        strat_leaseback: { text: "Strategy: Seller Rent-Back. We will negotiate a leaseback agreement, allowing you to stay in your home for up to 60 days after closing while you shop.", options: [] },
        strat_luxury_listing: { text: "Strategy: Luxury Portfolio. Properties over $800k require 'Lifestyle Marketing'. We will implement twilight photography, video tours, and international syndication.", options: [] },
        strat_tenant_sale: { text: "Strategy: Investor-to-Investor Sale. Since tenants are on a long lease, we market the property based on its 'Cap Rate' and cash flow to other investors.", options: [] },
        strat_concierge: { text: "Strategy: Concierge Listing. We prioritize Price. Implementation of staging, pre-listing inspection, and high-end drone photography.", options: [] },
        strat_instant: { text: "Strategy: Aggressive Pricing / iBuyer. We prioritize Speed. We will price slightly below comps to induce a bidding war or solicit cash offers.", options: [] },
        strat_hold_rent: { text: "Strategy: Rent & Hold. You have low equity but aren't distressed. Selling now means bringing cash to close. It is better to rent the unit until equity recovers.", options: [] },
        strat_short_sale: { text: "Strategy: Negotiated Short Sale. We must negotiate a 'Waiver of Deficiency' as part of the sale. This protects your other assets.", options: [] },
        strat_deed_lieu: { text: "Strategy: Deed in Lieu. If you are insolvent with only one lien, we offer the deed to the bank. This 'Cash for Keys' approach avoids foreclosure stigma.", options: [] },
        strat_probate_easy: { text: "Strategy: Standard Estate Sale. Independent Administration allows you to sell without court approval. We proceed as a standard listing.", options: [] },
        strat_probate_court: { text: "Strategy: Court-Approved Sale. We must include a 'Court Approval Contingency' in any contract. Expect a 45-60 day closing window.", options: [] },
        strat_probate_bond: { text: "Strategy: Bond in Lieu. To speed this up, we can work with a title company to issue a 'Bond in Lieu', allowing us to sell before probate ends.", options: [] },
        strat_turnkey: { text: "Strategy: Turnkey Investing. As a beginner, we should look for properties that are already renovated and tenanted. This minimizes risk.", options: [] },
        strat_dst: { text: "Strategy: Delaware Statutory Trust (DST). Since you are in a time crunch for your 1031 exchange, a DST allows you to park your funds in a passive property immediately.", options: [] },
        strat_fix_flip: { text: "Strategy: Fix & Flip (70% Rule). We only buy if (Purchase + Repairs) < 70% of After Repair Value. Focus on distressed Class C properties.", options: [] },
        strat_brrrr: { text: "Strategy: BRRRR Method. Buy, Rehab, Rent, Refinance, Repeat. Focus on DSCR for the cash-out refi.", options: [] },
        strat_buy_hold: { text: "Strategy: Cash Flow Focus. We target multi-family units where the Cap Rate exceeds 6-8%. Focus on stable tenant history.", options: [] },
        strat_syndication: { text: "Strategy: Syndication LP. You provide capital to a General Partner for a large commercial deal. Totally passive.", options: [] },
        strat_reit: { text: "Strategy: Public REITs. Since you are not accredited, we focus on publicly traded Real Estate Investment Trusts.", options: [] },
        strat_hold_refi: { text: "Strategy: Hold & Refinance. Your equity is working hard. We should look at a Cash-Out Refinance to buy another asset.", options: [] },
        strat_1031: { text: "Strategy: 1031 Exchange. Your equity is 'lazy'. We should sell this asset and defer taxes by rolling the proceeds into a higher-performing property.", options: [] },
        strat_sba_504: { text: "Strategy: SBA 504 Loan. As an owner-user, you can buy a building with only 10% down.", options: [] },
        strat_lease_audit: { text: "Strategy: NNN Lease Audit. We must audit the landlord's 'CAM' charges to ensure you aren't overpaying.", options: [] },
        strat_lease_base_year: { text: "Strategy: Base Year Stop. We negotiate a 'Gross' lease where you only pay for tax/expense increases *above* a base year.", options: [] },
        strat_industrial_logistics: { text: "Strategy: Logistics/Flex Focus. Demand is high for 2000sqft bays with 14ft doors. Focus on 'Last Mile' locations.", options: [] },
        res_conventional_check: { text: "Strategy: Conventional 3-5% Down. With your excellent credit, we skip FHA. We target Conventional loans with minimal PMI that falls off automatically once you hit 20% equity.", options: [] }
    };

    let currentNode = 'start';
    let history = []; 
    let pathLabels = []; 

    const elements = {
        question: document.getElementById('question-text'),
        options: document.getElementById('options-container'),
        backBtn: document.getElementById('back-btn'),
        progress: document.getElementById('progress-bar-fill'),
        step: document.getElementById('step-counter'),
        formContainer: document.getElementById('contact-form-container'),
        message: document.getElementById('message-field')
    };

    function renderNode() {
        const node = tree[currentNode];
        if(!node) {
            console.error("Node not found:", currentNode);
            return;
        }

        elements.question.innerText = node.text;
        elements.options.innerHTML = '';
        
        const isResult = node.options.length === 0;
        const stepCount = history.length + 1;
        
        elements.step.innerText = isResult ? 'Recommendation Found' : `Step ${stepCount}`;
        // Adjusted progress bar math for deeper tree
        elements.progress.style.width = isResult ? '100%' : Math.min(stepCount * 10, 95) + '%';
        elements.backBtn.style.display = (history.length > 0) ? 'block' : 'none';

        if (isResult) {
            elements.question.classList.add('result-card');
            elements.formContainer.style.display = 'block';
            
            let complianceNote = "\n\n*Local Compliance Note (Villa Park/IL):* \n- Transfer Stamps: $0 (Villa Park), but Inspection Required ($50).\n- Mandatory Disclosures: IL Radon, Lead-Based Paint (Pre-1978).";
            elements.message.value = "Client Path: " + pathLabels.join(" > ") + "\n\nGenerated Strategy: " + node.text + complianceNote;
            
            const restartBtn = document.createElement('button');
            restartBtn.innerText = "Start Over / Try Another Scenario";
            restartBtn.className = "tree-option-btn";
            restartBtn.style.textAlign = "center";
            restartBtn.style.marginTop = "20px";
            restartBtn.style.background = "#fff";
            restartBtn.onclick = () => { 
                history = []; 
                pathLabels = []; 
                currentNode = 'start'; 
                renderNode(); 
            };
            elements.options.appendChild(restartBtn);
        } else {
            elements.question.classList.remove('result-card');
            elements.formContainer.style.display = 'none';
            node.options.forEach(opt => {
                const btn = document.createElement('button');
                btn.innerText = opt.label;
                btn.className = "tree-option-btn";
                btn.onclick = () => {
                    history.push(currentNode);
                    pathLabels.push(opt.label);
                    currentNode = opt.next;
                    renderNode();
                };
                elements.options.appendChild(btn);
            });
        }
    }

    elements.backBtn.onclick = () => {
        if (history.length > 0) {
            currentNode = history.pop();
            pathLabels.pop();
            renderNode();
        }
    };

    renderNode();
});
</script>
</body>
</html>
