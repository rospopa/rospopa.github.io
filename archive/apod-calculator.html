<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Commercial Real Estate APOD Calculator">
    <link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/css/favicons/unnamed-180x180.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/css/favicons/unnamed-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/css/favicons/unnamed-32x32.png">
    <link rel="icon" type="image/png" sizes="180x180" href="/css/favicons/unnamed-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/css/favicons/unnamed-192x192.png">
    <link rel="icon" type="image/png" sizes="231x231" href="/css/favicons/unnamed-231x231.png">
    <title>Commercial Real Estate APOD Calculator</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans+Inscriptional+Pahlavi&amp;display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.5.5/css/simple-line-icons.min.css">

    <style>
        /* 1:1 Style Match for the UI */
        .site-header { background-color: #f8f9fa; border-bottom: 1px solid #dee2e6; padding: 1rem 0; }
        .wrap { max-width: 1400px; margin: 0 auto; padding: 0 15px; }
        .site-title { font-size: 1.5rem; font-weight: 600; color: #333; }
        .site-nav { float: right; }
        .site-nav .trigger2 { display: none; }
        .page-content { padding: 2rem 0; }
        .calcheaderbtn { margin-bottom: 20px; display: flex; gap: 10px; }
        .subsection-heading { text-align: center; margin-bottom: 15px; font-weight: 700; text-transform: uppercase; }
        .mtool { color: #1DA1F2; cursor: help; margin-right: 3px; }
        
        /* Triangle Buttons from your template */
        .triangle-add { width: 0; height: 0; border-left: 10px solid transparent; border-right: 10px solid transparent; border-bottom: 15px solid #28a745; cursor: pointer; display: inline-block; }
        .triangle-rem { width: 0; height: 0; border-left: 10px solid transparent; border-right: 10px solid transparent; border-top: 15px solid #dc3545; cursor: pointer; display: inline-block; }
        
        /* Table Input Styling to match "Transparent Spreadsheet" look */
        .table input { border: none; background: transparent; width: 100%; outline: none; }
        .table input:focus { background: rgba(29, 161, 242, 0.1); }
        
        /* Section Backgrounds */
        .subsection.expenses { background: rgb(240, 128, 128); }
        .subsection.revenue { background: #d4edda; }
        .subsection.summary { background: #fff3cd; }

        @media (max-width: 768px) {
            .site-nav .trigger { display: none; }
            .site-nav .trigger2 { display: inline-block; }
        }
    </style>
</head>

<body>
<header class="site-header">
    <div class="wrap">
        <a class="site-title" style="text-decoration: none;" href="https://rospopa.com">Pavlo Rospopa Website</a>
        <nav class="site-nav">
            <div class="trigger">
                <a style="text-decoration: none;" href="mailto:pavlo@rospopa.com?subject=APOD-Calculator">pavlo@rospopa.com</a>
            </div>
            <div class="trigger2">
                <a style="text-decoration: none;" href="mailto:pavlo@rospopa.com?subject=APOD-Calculator">@</a>
            </div>
        </nav>
    </div>
</header>

<main>
    <div class="page-content">
        <div id="topdf" class="wrap">
            <div id="calculator">
                <h2 class="text-center" id="main-title-address"></h2>
                
                <div class="calcheaderbtn">
                    <div class="modal fade" role="dialog" tabindex="-1" id="confirmModal">
                        <div class="modal-dialog modal-sm" role="document">
                            <div class="modal-content">
                                <div class="modal-header" style="padding-bottom: 10px;">
                                    <button class="btn-close" type="button" data-bs-dismiss="modal"></button>
                                </div>
                                <div class="modal-body">
                                    <h2 class="text-center" style="margin-bottom: 0px;margin-top: 5px;">Confirm Reset?</h2>
                                </div>
                                <div class="modal-footer justify-content-evenly">
                                    <button class="btn btn-success" id="btnno" type="button" data-bs-dismiss="modal"><span>NO</span></button>
                                    <button class="btn btn-secondary" id="resetAll" type="button" data-bs-dismiss="modal"><span>YES</span></button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-secondary btn-sm" id="bt-reset-modal" type="button" data-bs-toggle="modal" data-bs-target="#confirmModal"><span>RESET</span></button>
                    <button class="btn btn-primary btn-sm" id="savepdf" type="button"><span>PDF</span></button>
                    <button class="btn btn-success btn-sm" id="sendtoemail" type="button"><span>E-MAIL</span></button>
                </div>

                <div class="mb-3">
                    <div class="row" style="border: 1px dashed #1DA1F2;">
                        <div class="col-md-12">
                            <label class="form-label" for="autocomplete"><sup class="mtool" title="Address"><i class="icon-question"></i></sup>Address*</label>
                            <div class="input-group"><span class="input-group-text">Address</span><input type="text" id="autocomplete" class="form-control" value="75th St Downers Grove"></div>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label" for="B1"><sup class="mtool" title="Purchase Price $"><i class="icon-question"></i></sup>Purchase Price</label>
                            <div class="input-group"><span class="input-group-text">$</span><input class="form-control" type="number" id="B1" value="5900000" oninput="calculate()"></div>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label" for="B4"><sup class="mtool" title="Closing Date"><i class="icon-question"></i></sup>Closing Date</label>
                            <div class="input-group"><input class="form-control" id="B4" type="date"></div>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label" for="A4"><sup class="mtool" title="Days Remain"><i class="icon-question"></i></sup>Remain</label>
                            <div class="input-group"><input class="form-control" type="text" id="A4" readonly><span class="input-group-text">days</span></div>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label" for="A4_2"><sup class="mtool" title="Days Passed"><i class="icon-question"></i></sup>Passed</label>
                            <div class="input-group"><input class="form-control" type="number" id="A4_2" value="0" oninput="calculate()"><span class="input-group-text">days</span></div>
                        </div>
                    </div>

                    <h4 class="text-center mt-3">Loan Profile</h4>
                    <div class="row" style="border: 1px dashed #1DA1F2;">
                        <div class="col-md-3">
                            <label class="form-label" for="B2"><sup class="mtool" title="Down Payment %"><i class="icon-question"></i></sup>Down Payment</label>
                            <div class="input-group"><input class="form-control" type="number" id="B2" value="100" oninput="updateDownPayment()"><span class="input-group-text">%</span></div>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label" for="B3"><sup class="mtool" title="Down Payment $"><i class="icon-question"></i></sup>Down Payment</label>
                            <div class="input-group"><span class="input-group-text">$</span><input class="form-control" type="number" id="B3" value="5900000" oninput="calculate()"></div>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label" for="Loan-Type"><sup class="mtool" title="Loan Type"><i class="icon-question"></i></sup>Loan Type</label>
                            <select class="form-select form-control" id="Loan-Type">
                                <option value="None (All Cash)">None (All Cash)</option>
                                <option value="Conventional Loan">Conventional Loan</option>
                                <option value="Commercial Loan">Commercial Loan</option>
                                <option value="DSCR Loan">DSCR Loan</option>
                            </select>
                        </div>
                        <div class="col-md-3 mt-2">
                            <label class="form-label">Annual Interest Rate</label>
                            <div class="input-group"><input class="form-control" type="number" id="B6" value="5.79" step="0.01" oninput="calculate()"><span class="input-group-text">%</span></div>
                        </div>
                        <div class="col-md-3 mt-2">
                            <label class="form-label">Loan Amount</label>
                            <div class="input-group"><span class="input-group-text">$</span><input class="form-control" id="B5" readonly></div>
                        </div>
                    </div>
                </div>

                <div class="subsection revenue">
                    <h4 class="subsection-heading">Rent Roll</h4>
                    <div class="table-responsive">
                        <table class="table table-striped table-hover table-bordered bg-white">
                            <thead>
                                <tr>
                                    <th>
                                        <div class="row d-flex align-items-center">
                                            <div class="col text-nowrap">Tenant Name</div>
                                            <div class="col d-flex justify-content-center">
                                                <div id="addTenant" class="triangle-add" onclick="addTenant()"></div>
                                            </div>
                                        </div>
                                    </th>
                                    <th>Sq Ft</th>
                                    <th>Monthly Rent</th>
                                    <th>Recovery PSF</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="tenantList"></tbody>
                        </table>
                    </div>
                </div>

                <div class="subsection expenses mt-4">
                    <h4 class="subsection-heading">Annual Operating Expenses</h4>
                    <div class="table-responsive">
                        <table class="table table-hover table-bordered bg-white">
                            <thead>
                                <tr><th>Expense Item</th><th>Amount ($)</th></tr>
                            </thead>
                            <tbody>
                                <tr><td>Property Taxes</td><td><input type="number" id="A5" value="380154" oninput="calculate()"></td></tr>
                                <tr><td>Insurance</td><td><input type="number" id="propertyInsurance" value="32000" oninput="calculate()"></td></tr>
                                <tr><td>Management</td><td><input type="number" id="offSiteManagement" value="84047" oninput="calculate()"></td></tr>
                                <tr><td>Repairs</td><td><input type="number" id="repairsMaint" value="242104" oninput="calculate()"></td></tr>
                                <tr><td>Utilities</td><td><input type="number" id="utilities" value="109140" oninput="calculate()"></td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="subsection summary mt-4">
                    <h4 class="subsection-heading">Financial Summary</h4>
                    <div class="table-responsive">
                        <table class="table table-bordered bg-white">
                            <tbody>
                                <tr class="table-primary text-center"><td colspan="2"><h3 class="mb-0">NOI: <strong id="noiDisplay">$0</strong></h3></td></tr>
                                <tr><td>Scheduled Rental Income</td><td class="text-end text-success" id="rentalDisplay">$0</td></tr>
                                <tr><td>Cap Rate</td><td class="text-end" id="capRateDisplay">0%</td></tr>
                                <tr><td>Cash on Cash</td><td class="text-end" id="cocDisplay">0%</td></tr>
                                <tr><td>DCR</td><td class="text-end" id="dcrDisplay">0.00</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <section class="mt-4">
                    <h5 class="font-monospace lh-1 text-center" style="font-size: 0.8rem; color: #666;">Disclaimer.<br>Use this calculator for REVIEW and TESTING purposes only.<br>(It's not a substitute for your calculations.)</h5>
                </section>
            </div>
        </div>
    </div>
</main>

<footer class="site-footer">
    <div class="wrap">
        <div class="home">
            <p>Go to <a href="https://www.linkedin.com/in/prospopa/">LinkedIn</a>.</p>
            <p>Go to <a href="https://github.com/rospopa">GitHub</a>.</p>
            <p>Return to <a href="#top">Top of This Page</a>.</p>
            <section class="d-flex flex-row justify-content-center" style="width:100%;">
                <div class="container" style="margin:0; padding:20px 0; width:100%;">
                    <div class="text-center">
                        <p class="mb-0">Copyright Â© <span id="currentYear"></span> All Rights Reserved.</p>
                    </div>
                </div>
            </section>
        </div>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
    document.getElementById('currentYear').textContent = new Date().getFullYear();
    let tenants = [{id: Date.now(), name: 'Anchor Store', sqFt: 32450, monthlyRent: 14873, recoveryPSF: 3.90}];

    function updateDownPayment() {
        const price = parseFloat(document.getElementById('B1').value) || 0;
        const pct = parseFloat(document.getElementById('B2').value) || 0;
        const down = (price * pct) / 100;
        document.getElementById('B3').value = down.toFixed(0);
        document.getElementById('B5').value = (price - down).toFixed(0);
        calculate();
    }

    function addTenant() {
        tenants.push({ id: Date.now(), name: '', sqFt: 0, monthlyRent: 0, recoveryPSF: 0 });
        renderTenants();
        calculate();
    }

    function removeTenant(id) {
        tenants = tenants.filter(t => t.id !== id);
        renderTenants();
        calculate();
    }

    function updateTenant(id, field, value) {
        const tenant = tenants.find(t => t.id === id);
        if (tenant) { tenant[field] = value; calculate(); }
    }

    function renderTenants() {
        const container = document.getElementById('tenantList');
        container.innerHTML = tenants.map((t, i) => `
            <tr>
                <td><input type="text" value="${t.name}" onchange="updateTenant(${t.id}, 'name', this.value)" placeholder="Tenant Name"></td>
                <td><input type="number" value="${t.sqFt}" oninput="updateTenant(${t.id}, 'sqFt', parseFloat(this.value)||0)"></td>
                <td><input type="number" value="${t.monthlyRent}" oninput="updateTenant(${t.id}, 'monthlyRent', parseFloat(this.value)||0)"></td>
                <td><input type="number" value="${t.recoveryPSF}" step="0.01" oninput="updateTenant(${t.id}, 'recoveryPSF', parseFloat(this.value)||0)"></td>
                <td class="text-center"><div class="triangle-rem" onclick="removeTenant(${t.id})"></div></td>
            </tr>
        `).join('');
    }

    function calculate() {
        const price = parseFloat(document.getElementById('B1').value) || 0;
        const down = parseFloat(document.getElementById('B3').value) || 0;
        const loan = price - down;
        document.getElementById('B5').value = loan.toFixed(0);

        let rental = 0, recovery = 0;
        tenants.forEach(t => { 
            rental += t.monthlyRent * 12; 
            recovery += (t.sqFt * t.recoveryPSF) * 12; 
        });

        const expenses = ['A5', 'propertyInsurance', 'offSiteManagement', 'repairsMaint', 'utilities']
            .reduce((sum, id) => sum + (parseFloat(document.getElementById(id).value) || 0), 0);
        
        const noi = (rental + recovery) - expenses;
        const cap = price > 0 ? (noi / price) * 100 : 0;

        // Debt Calc
        const rate = parseFloat(document.getElementById('B6').value) || 0;
        const i = rate / 100 / 12;
        const n = 360; 
        const mPay = loan > 0 && i > 0 ? loan * (i * Math.pow(1+i, n)) / (Math.pow(1+i, n) - 1) : 0;
        const annualDebt = mPay * 12;

        document.getElementById('noiDisplay').textContent = '$' + noi.toLocaleString(undefined, {maximumFractionDigits:0});
        document.getElementById('rentalDisplay').textContent = '$' + rental.toLocaleString();
        document.getElementById('capRateDisplay').textContent = cap.toFixed(2) + '%';
        document.getElementById('dcrDisplay').textContent = annualDebt > 0 ? (noi / annualDebt).toFixed(2) : '0.00';
        document.getElementById('cocDisplay').textContent = down > 0 ? (((noi - annualDebt)/down)*100).toFixed(2) + '%' : '0%';
    }

    document.getElementById('resetAll').addEventListener('click', () => location.reload());
    renderTenants();
    calculate();
</script>

</body>
</html>
